<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Einführung in R - Statistische Modellierung</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


<link rel="stylesheet" href="../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg navbar-dark ">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">Einführung in R</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../index.html" rel="" target="">
 <span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Themen/01/01_Allgemeines.html" rel="" target="">
 <span class="menu-text">Allgemeines</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Themen/02/02_DeskriptiveStats.html" rel="" target="">
 <span class="menu-text">Deskriptive Statistik</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Themen/03/03_Graph.html" rel="" target="">
 <span class="menu-text">Grafische Darstellungen</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Themen/04/04_Anova.html" rel="" target="">
 <span class="menu-text">ANOVA</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../Themen/05/05_Regression.html" rel="" target="">
 <span class="menu-text">Regression</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="../../Themen/06/06_StatMod.html" rel="" target="" aria-current="page">
 <span class="menu-text">Statistische Modellierung</span></a>
  </li>  
</ul>
            <div class="quarto-navbar-tools ms-auto">
</div>
          </div> <!-- /navcollapse -->
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#prinzip-der-parsimonität---wie-viele-parameter-bedarf-es-um-einen-elefanten-zu-modellieren" id="toc-prinzip-der-parsimonität---wie-viele-parameter-bedarf-es-um-einen-elefanten-zu-modellieren" class="nav-link active" data-scroll-target="#prinzip-der-parsimonität---wie-viele-parameter-bedarf-es-um-einen-elefanten-zu-modellieren">Prinzip der Parsimonität - Wie viele Parameter bedarf es um einen Elefanten zu modellieren?</a></li>
  <li><a href="#ziel-der-statistischen-modellierung" id="toc-ziel-der-statistischen-modellierung" class="nav-link" data-scroll-target="#ziel-der-statistischen-modellierung">Ziel der statistischen Modellierung</a></li>
  <li><a href="#modelltypen" id="toc-modelltypen" class="nav-link" data-scroll-target="#modelltypen">Modelltypen</a></li>
  <li><a href="#erklärungsvariablen" id="toc-erklärungsvariablen" class="nav-link" data-scroll-target="#erklärungsvariablen">Erklärungsvariablen</a></li>
  <li><a href="#statistische-interaktion-wechselwirkung" id="toc-statistische-interaktion-wechselwirkung" class="nav-link" data-scroll-target="#statistische-interaktion-wechselwirkung">Statistische Interaktion (Wechselwirkung)</a></li>
  <li><a href="#mehrere-erklärungsvariablen-im-modell" id="toc-mehrere-erklärungsvariablen-im-modell" class="nav-link" data-scroll-target="#mehrere-erklärungsvariablen-im-modell">Mehrere Erklärungsvariablen im Modell</a></li>
  <li><a href="#beispiel-modell--und-variablenselektion" id="toc-beispiel-modell--und-variablenselektion" class="nav-link" data-scroll-target="#beispiel-modell--und-variablenselektion">Beispiel: Modell- und Variablenselektion</a>
  <ul class="collapse">
  <li><a href="#daten-einlesen-kennenlernen-plotten" id="toc-daten-einlesen-kennenlernen-plotten" class="nav-link" data-scroll-target="#daten-einlesen-kennenlernen-plotten">Daten einlesen, kennenlernen, plotten</a></li>
  </ul></li>
  <li><a href="#korrelation-zwischen-erklärungsvariablen-testen" id="toc-korrelation-zwischen-erklärungsvariablen-testen" class="nav-link" data-scroll-target="#korrelation-zwischen-erklärungsvariablen-testen">Korrelation zwischen Erklärungsvariablen testen</a>
  <ul class="collapse">
  <li><a href="#mit-der-ggpairs-und-libraryggally" id="toc-mit-der-ggpairs-und-libraryggally" class="nav-link" data-scroll-target="#mit-der-ggpairs-und-libraryggally">mit der ggpairs() und library(GGally)</a></li>
  <li><a href="#mit-einer-korrelationsmatrix" id="toc-mit-einer-korrelationsmatrix" class="nav-link" data-scroll-target="#mit-einer-korrelationsmatrix">mit einer Korrelationsmatrix</a></li>
  <li><a href="#mit-dem-variance-inflation-factor-vif" id="toc-mit-dem-variance-inflation-factor-vif" class="nav-link" data-scroll-target="#mit-dem-variance-inflation-factor-vif">mit dem Variance Inflation Factor (VIF)</a></li>
  </ul></li>
  <li><a href="#modell-formulieren" id="toc-modell-formulieren" class="nav-link" data-scroll-target="#modell-formulieren">Modell formulieren</a></li>
  <li><a href="#modellvereinfachung--selektion" id="toc-modellvereinfachung--selektion" class="nav-link" data-scroll-target="#modellvereinfachung--selektion">Modellvereinfachung, -selektion</a>
  <ul class="collapse">
  <li><a href="#schrittweise-modellvereinfachung-mit-drop1-basierend-auf-teststatistik" id="toc-schrittweise-modellvereinfachung-mit-drop1-basierend-auf-teststatistik" class="nav-link" data-scroll-target="#schrittweise-modellvereinfachung-mit-drop1-basierend-auf-teststatistik">Schrittweise Modellvereinfachung mit drop1() basierend auf Teststatistik</a></li>
  <li><a href="#übung-6.1." id="toc-übung-6.1." class="nav-link" data-scroll-target="#übung-6.1.">Übung 6.1.</a></li>
  </ul></li>
  <li><a href="#modellselektion-basierend-auf-informationskriterien" id="toc-modellselektion-basierend-auf-informationskriterien" class="nav-link" data-scroll-target="#modellselektion-basierend-auf-informationskriterien">Modellselektion basierend auf Informationskriterien</a></li>
  <li><a href="#schrittweise-verfahren-basierend-auf-aic-mit-step" id="toc-schrittweise-verfahren-basierend-auf-aic-mit-step" class="nav-link" data-scroll-target="#schrittweise-verfahren-basierend-auf-aic-mit-step">Schrittweise Verfahren basierend auf AIC mit step()</a>
  <ul class="collapse">
  <li><a href="#step-backward" id="toc-step-backward" class="nav-link" data-scroll-target="#step-backward">step backward</a></li>
  <li><a href="#step-forward" id="toc-step-forward" class="nav-link" data-scroll-target="#step-forward">step forward</a></li>
  <li><a href="#step-both" id="toc-step-both" class="nav-link" data-scroll-target="#step-both">step both</a></li>
  <li><a href="#übung-6.2." id="toc-übung-6.2." class="nav-link" data-scroll-target="#übung-6.2.">Übung 6.2.</a></li>
  </ul></li>
  <li><a href="#modellvergleiche-basierend-auf-aic-mit-dregde" id="toc-modellvergleiche-basierend-auf-aic-mit-dregde" class="nav-link" data-scroll-target="#modellvergleiche-basierend-auf-aic-mit-dregde">Modellvergleiche basierend auf AIC mit dregde()</a></li>
  <li><a href="#modellvergleiche-basierend-auf-aic-mit-eigenem-set-an-candidate-models" id="toc-modellvergleiche-basierend-auf-aic-mit-eigenem-set-an-candidate-models" class="nav-link" data-scroll-target="#modellvergleiche-basierend-auf-aic-mit-eigenem-set-an-candidate-models">Modellvergleiche basierend auf AIC mit eigenem Set an Candidate Models</a></li>
  <li><a href="#modellvergleiche-basierend-auf-aic-mit-glmulti" id="toc-modellvergleiche-basierend-auf-aic-mit-glmulti" class="nav-link" data-scroll-target="#modellvergleiche-basierend-auf-aic-mit-glmulti">Modellvergleiche basierend auf AIC mit glmulti()</a>
  <ul class="collapse">
  <li><a href="#übung-6.3." id="toc-übung-6.3." class="nav-link" data-scroll-target="#übung-6.3.">Übung 6.3.</a></li>
  </ul></li>
  <li><a href="#modelldiagnostik" id="toc-modelldiagnostik" class="nav-link" data-scroll-target="#modelldiagnostik">Modelldiagnostik</a></li>
  <li><a href="#modellinterpretation" id="toc-modellinterpretation" class="nav-link" data-scroll-target="#modellinterpretation">Modellinterpretation</a>
  <ul class="collapse">
  <li><a href="#schnell-und-einfach-mit-libraryeffects" id="toc-schnell-und-einfach-mit-libraryeffects" class="nav-link" data-scroll-target="#schnell-und-einfach-mit-libraryeffects">schnell und einfach mit <code>library(effects)</code></a></li>
  <li><a href="#weitere-alternativen-zur-modellinterpretation-i.e.-abbildung-der-ergebnisse" id="toc-weitere-alternativen-zur-modellinterpretation-i.e.-abbildung-der-ergebnisse" class="nav-link" data-scroll-target="#weitere-alternativen-zur-modellinterpretation-i.e.-abbildung-der-ergebnisse">Weitere Alternativen zur Modellinterpretation, i.e.&nbsp;Abbildung der Ergebnisse:</a></li>
  <li><a href="#übung-6.4." id="toc-übung-6.4." class="nav-link" data-scroll-target="#übung-6.4.">Übung 6.4.</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Statistische Modellierung</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<ul>
<li>Alle Modelle sind falsch.</li>
<li>Manche Modelle sind besser als andere.</li>
<li>Das richtige Modell kann niemals mit absoluter Sicherheit bestimmt werden.</li>
<li>Je einfacher ein Modell ist, desto besser. <em>“the principle of parsimony: the correct explanation is the simplest explanation”</em></li>
<li><em>“Man muss die Dinge so einfach wie möglich machen. Aber nicht einfacher.”</em> Albert Einstein</li>
</ul>
<section id="prinzip-der-parsimonität---wie-viele-parameter-bedarf-es-um-einen-elefanten-zu-modellieren" class="level2">
<h2 class="anchored" data-anchor-id="prinzip-der-parsimonität---wie-viele-parameter-bedarf-es-um-einen-elefanten-zu-modellieren">Prinzip der Parsimonität - Wie viele Parameter bedarf es um einen Elefanten zu modellieren?</h2>
<p><img src="Elephant.png" class="img-fluid"></p>
<ol type="A">
<li>36, B) 5, C) 10, D) 20 und E) 30 Parameter</li>
</ol>
<p><em>The 30-term elephant “may not satisfy the third-grade art teacher, but would carry most chemical engineers into preliminary design.”</em></p>
<p>aus:<br>
Burnham K, Anderson D. 2002. Model selection and multimodel inference. Springer, USA.<br>
Wei J. 1975. Least square fitting of an elephant. Chemtech 5: 128-129.</p>
</section>
<section id="ziel-der-statistischen-modellierung" class="level2">
<h2 class="anchored" data-anchor-id="ziel-der-statistischen-modellierung">Ziel der statistischen Modellierung</h2>
<ul>
<li>Selektion des minimalen adäquaten Modells aus einem großen Pool verschieden komplexer Modelle</li>
</ul>
</section>
<section id="modelltypen" class="level2">
<h2 class="anchored" data-anchor-id="modelltypen">Modelltypen</h2>
<ul>
<li>Volles Model (<em>full model</em>, maximales Modell, globales Modell, alle Erklärungsvariablen inkl. Interaktionen, Freiheitsgrade = n - p - 1)</li>
<li><em>candidate model</em> (verschiedene mögliche Modelle die <em>subsets</em> des globalen Modells sind, d.h. unterschiedliche Erklärungsvariablen beinhalten)</li>
<li>Minimales adäquates Modell (<em>mimimal adequate model</em>, vereinfachtes oder <em>“bestes”</em> Modell entsprechend dem Prinzip der Parsimonität)</li>
<li>Nullmodell (<em>null model</em>, nur Intercept ~1, i.e.&nbsp;Mittelwert, wird gefittet)</li>
<li>Gesättigtes Modell (<em>saturated model</em>, eine Erklärungsvariable für jeden Punkt = keine Freiheitsgrade)</li>
</ul>
</section>
<section id="erklärungsvariablen" class="level2">
<h2 class="anchored" data-anchor-id="erklärungsvariablen">Erklärungsvariablen</h2>
<ul>
<li>Welche Erklärungsvariablen?
<ul>
<li>biologisch sinnvoll</li>
<li>entsprechend Fragestellung und Literatur</li>
<li>Designvariablen</li>
</ul></li>
<li>Korrelation zwischen Erklärungsvariablen prüfen
<ul>
<li>kann zu verzerrten Schätzungen der Modellparameter und Fehler führen</li>
<li>Daumenregel r &lt; 0,7</li>
<li><em>variance inflation factor</em> VIF &lt; 3</li>
</ul></li>
<li>Anzahl Erklärungsvariablen an Stichprobenumfang anpassen
<ul>
<li>Gefahr der Überparametrisierung</li>
<li>Daumenregel je Parameter 10 Stichproben (häufig nicht realisierbar)</li>
<li>in landwirtschaftlichen Versuchen häufig 4 Wdh</li>
</ul></li>
<li>Beziehungen zwischen Abhängigen und Erklärungsvariable überprüfen
<ul>
<li>Linearität vs.&nbsp;Kurvatur <a href="https://doreengabriel.github.io/Kurs/Themen/05/05_Regression.html#%C3%BCbung-5" target="_blank">Übung 5</a></li>
<li>Verteilung der kontinierlichen Erklärungsvariable (Schiefe, Länge des Gradienten)</li>
<li>N bei kategorialen Erklärungsvariable (balanciert, Anzahl Stichproben je Gruppe)</li>
</ul></li>
<li>Welche Interaktionen? (alle, keine, nur zweifach, entsprechend Fragestellung)</li>
</ul>
</section>
<section id="statistische-interaktion-wechselwirkung" class="level2">
<h2 class="anchored" data-anchor-id="statistische-interaktion-wechselwirkung">Statistische Interaktion (Wechselwirkung)</h2>
<p>wenn der Effekt einer Erklärungsvariable von dem Wert der anderen Erklärungsvariable abhängt</p>
<p><img src="interaktion.png" class="img-fluid"></p>
</section>
<section id="mehrere-erklärungsvariablen-im-modell" class="level2">
<h2 class="anchored" data-anchor-id="mehrere-erklärungsvariablen-im-modell">Mehrere Erklärungsvariablen im Modell</h2>
<table class="table">
<colgroup>
<col style="width: 2%">
<col style="width: 20%">
<col style="width: 76%">
</colgroup>
<thead>
<tr class="header">
<th>Nr</th>
<th>Modellformel</th>
<th>Modellparameter</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>1</td>
<td><code>lm(y~x+z)</code></td>
<td>zwei Erklärungsvariablen</td>
</tr>
<tr class="even">
<td>2</td>
<td><code>lm(y~x*z)</code></td>
<td>zwei Erklärungsvariablen und deren Interaktion</td>
</tr>
<tr class="odd">
<td>3</td>
<td><code>lm(y~x+z+x:z)</code></td>
<td>zwei Erklärungsvariablen und deren Interaktion</td>
</tr>
<tr class="even">
<td>4</td>
<td><code>lm(y~x+z+w)</code></td>
<td>drei Erklärungsvariablen</td>
</tr>
<tr class="odd">
<td>5</td>
<td><code>lm(y~x+z+w+x:z+z:w+w:x)</code></td>
<td>drei Erklärungsvariablen und alle Zweifach-Interaktionen</td>
</tr>
<tr class="even">
<td>6</td>
<td><code>lm(y~(x+z+w)^2)</code></td>
<td>drei Erklärungsvariablen und alle Zweifach-Interaktionen</td>
</tr>
<tr class="odd">
<td>7</td>
<td><code>lm(y~x+z+w+x:z+z:w+w:x+z:w:x)</code></td>
<td>drei Erklärungsvariablen und alle Interaktionen</td>
</tr>
<tr class="even">
<td>8</td>
<td><code>lm(y~x*z*w)</code></td>
<td>drei Erklärungsvariablen und alle Interaktionen</td>
</tr>
</tbody>
</table>
<p>Modell Nr. 2 und 3 sind identische Modelle, ebenso Nr. 5 und 6 und Nr. 7 und 8.</p>
</section>
<section id="beispiel-modell--und-variablenselektion" class="level2">
<h2 class="anchored" data-anchor-id="beispiel-modell--und-variablenselektion">Beispiel: Modell- und Variablenselektion</h2>
<p>Wir wollen nun verschiedene Modell- und Variablenselektionsstrategien an einem Beispieldatensatz zur Pflanzendiversität in Weizenfeldern rechnen.</p>
<p>Literatur zum Thema:</p>
<p>Heinze et al.&nbsp;(2018) <a href="https://onlinelibrary.wiley.com/doi/full/10.1002/bimj.201700067" target="_blank">Variable selection – A review and recommendations for the practicing statistician</a></p>
<section id="fragestellung" class="level4">
<h4 class="anchored" data-anchor-id="fragestellung">Fragestellung:</h4>
<p>Wie beeinflusst Bewirtschaftung (ökologisch vs.&nbsp;konventionell), Bodengüte (ertragreich vs.&nbsp;ertragsarm) und Landschaftsstruktur (strukturreich vs.&nbsp;strukturarm) die Pflanzendiversität in Weizenfeldern?</p>
</section>
<section id="untersuchungsdesign" class="level4">
<h4 class="anchored" data-anchor-id="untersuchungsdesign">Untersuchungsdesign:</h4>
<p>In 36 ökologisch und konventionell bewirtschafteten Weizenflächen (<code>Man = con vs. org</code>), welche sowohl in ihrer Bodengüte (<em>Soil quality</em> = <code>SQ</code>) als auch in der umgebenden Landschaftsstruktur (% Ackeranteil = <code>Arab</code>) variierten, wurde die Shannon-Diversität von Ackerwildkräutern (<code>Weeds</code>) ermittelt.</p>
</section>
<section id="daten-einlesen-kennenlernen-plotten" class="level3">
<h3 class="anchored" data-anchor-id="daten-einlesen-kennenlernen-plotten">Daten einlesen, kennenlernen, plotten</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(openxlsx)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>of<span class="ot">=</span><span class="fu">read.xlsx</span>(<span class="st">"organic_farming.xlsx"</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(of)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>'data.frame':   36 obs. of  5 variables:
 $ ID   : num  1 2 3 4 5 6 7 8 9 10 ...
 $ Man  : chr  "con" "org" "con" "org" ...
 $ Arab : num  21.2 21.4 24.3 26.3 31.3 29.4 36.1 34.6 38.9 41.9 ...
 $ SQ   : num  82 63 52 40 94 74 69 53 83 86 ...
 $ Weeds: num  3.35 3.5 3.28 3.57 2.96 3.35 3 3.5 3 3.54 ...</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>of<span class="sc">$</span>Man<span class="ot">=</span><span class="fu">as.factor</span>(of<span class="sc">$</span>Man)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(of)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       ID         Man          Arab             SQ            Weeds      
 Min.   : 1.00   con:18   Min.   :21.20   Min.   :38.00   Min.   :1.410  
 1st Qu.: 9.75   org:18   1st Qu.:41.15   1st Qu.:54.75   1st Qu.:2.438  
 Median :18.50            Median :60.50   Median :62.50   Median :2.980  
 Mean   :18.50            Mean   :59.89   Mean   :65.83   Mean   :2.789  
 3rd Qu.:27.25            3rd Qu.:80.65   3rd Qu.:79.25   3rd Qu.:3.290  
 Max.   :36.00            Max.   :94.10   Max.   :95.00   Max.   :3.570  </code></pre>
</div>
</div>
<p>Wir plotten zunächst die Daten entsprechend unserer Fragestellung:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>p1<span class="ot">=</span><span class="fu">ggplot</span>(of, <span class="fu">aes</span>(<span class="at">x=</span>Man, <span class="at">y=</span>Weeds, <span class="at">colour=</span>Man)) <span class="sc">+</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape=</span><span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width=</span><span class="fl">0.25</span>, <span class="at">shape=</span><span class="dv">1</span>)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>p2<span class="ot">=</span><span class="fu">ggplot</span>(of, <span class="fu">aes</span>(<span class="at">x=</span>Arab, <span class="at">y=</span>Weeds, <span class="at">colour=</span>Man)) <span class="sc">+</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm)</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>p3<span class="ot">=</span><span class="fu">ggplot</span>(of, <span class="fu">aes</span>(<span class="at">x=</span>SQ, <span class="at">y=</span>Weeds, <span class="at">colour=</span>Man)) <span class="sc">+</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>p4<span class="ot">=</span><span class="fu">ggplot</span>(of, <span class="fu">aes</span>(<span class="at">x=</span>Man, <span class="at">y=</span>Arab, <span class="at">colour=</span>Man)) <span class="sc">+</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape=</span><span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width=</span><span class="fl">0.25</span>, <span class="at">shape=</span><span class="dv">1</span>)</span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>p5<span class="ot">=</span><span class="fu">ggplot</span>(of, <span class="fu">aes</span>(<span class="at">x=</span>Man, <span class="at">y=</span>SQ, <span class="at">colour=</span>Man)) <span class="sc">+</span></span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape=</span><span class="cn">NA</span>) <span class="sc">+</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">width=</span><span class="fl">0.25</span>, <span class="at">shape=</span><span class="dv">1</span>)</span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a>p6<span class="ot">=</span><span class="fu">ggplot</span>(of, <span class="fu">aes</span>(<span class="at">x=</span>SQ, <span class="at">y=</span>Arab, <span class="at">colour=</span>Man)) <span class="sc">+</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm)</span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="fu">ggarrange</span>(p1, p2, p3, p4, p5, p6, <span class="at">common.legend =</span> <span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'
`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="06_StatMod_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="960"></p>
</div>
</div>
<p>Im Plot oben rechts sehen wir, dass die Diversität in ökologisch bewirtschafteten Flächen höher ist als in konventionellen. Wir sehen aber auch, dass die Variabilität sich deutlich (und um ein Vielfaches) zwischen <code>org</code> und <code>con</code> unterscheidet.</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>of <span class="sc">%&gt;%</span> </span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">group_by</span>(Man) <span class="sc">%&gt;%</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">summarise</span>(<span class="at">MW=</span><span class="fu">mean</span>(Weeds),</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>            <span class="at">VAR=</span><span class="fu">var</span>(Weeds))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 2 x 3
  Man      MW    VAR
  &lt;fct&gt; &lt;dbl&gt;  &lt;dbl&gt;
1 con    2.35 0.441 
2 org    3.23 0.0558</code></pre>
</div>
</div>
</div>
</div>
</div>
<p>Ist das ein Problem? NEIN. Wir müssen die Residuen nach der Analyse auf Varianzhomogenität checken. Wenn unsere Erklärungsvariablen die Variabilität in den Daten erklären, dann sollte der Restfehler varianzhomogen sein.<br>
Ausserdem sehen wir einen negativen Zusammenhang zwischen <code>Weeds</code>und <code>Arab</code> für <code>org</code> und <code>con</code> sowie eine mögliche Interaktion zwischen <code>Weeds</code> und <code>SQ</code> für <code>org</code> und <code>con</code>. Wir plotten ausserdem die Erklärungsvariablen gegeneinander, um mögliche Muster oder Zusammenhänge zu erkennen. Wir sehen, dass die Erklärungsvariablen <code>Arab</code> und <code>SQ</code> einen ähnlich weiten Wertebereich in <code>org</code>und <code>con</code> aufweisen. Außerdem scheint es keinen Zusammenhang zwischen <code>Arab</code> und <code>SQ</code> zu geben. Gut so.</p>
</section>
</section>
<section id="korrelation-zwischen-erklärungsvariablen-testen" class="level2">
<h2 class="anchored" data-anchor-id="korrelation-zwischen-erklärungsvariablen-testen">Korrelation zwischen Erklärungsvariablen testen</h2>
<p>Bevor wir ein Modell formulieren, sollten wir die Korrelation zwischen den Erklärungsvariablen prüfen. Eng korrleirte Erklärungsvariablen können zu verzerrten Modellkoeffizienten, hohe Standardfehler der Koeffizienten und damit zu instabilien Modellen und den falschen Schlussfolgerungen führen.</p>
<p>siehe auch Dormann et al.&nbsp;(2012) <a href="https://nsojournals.onlinelibrary.wiley.com/doi/full/10.1111/j.1600-0587.2012.07348.x" target="_blank">Collinearity: a review of methods to deal with it and a simulation study evaluating their performance</a></p>
<section id="mit-der-ggpairs-und-libraryggally" class="level3">
<h3 class="anchored" data-anchor-id="mit-der-ggpairs-und-libraryggally">mit der ggpairs() und library(GGally)</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(GGally)</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggpairs</span>(of, <span class="at">columns =</span> <span class="fu">c</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>), ggplot2<span class="sc">::</span><span class="fu">aes</span>(<span class="at">colour =</span> Man))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="06_StatMod_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid" width="960"></p>
</div>
</div>
</section>
<section id="mit-einer-korrelationsmatrix" class="level3">
<h3 class="anchored" data-anchor-id="mit-einer-korrelationsmatrix">mit einer Korrelationsmatrix</h3>
<p>Um eine Korrelationsmatrix zu erstellen, müssen alle Variablen numerisch sein. Ich codiere hier die Variable <code>Man</code> in eine dummy-Variable um. Da sie nur zwei Levels hat, wird eine Spalte mit der Information Man = 1 und org = 0 ausreichen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>of<span class="sc">$</span>Man.con<span class="ot">=</span><span class="fu">ifelse</span>(of<span class="sc">$</span>Man <span class="sc">==</span> <span class="st">"con"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Sollte man einen Faktor mit mehr als zwei Levels haben, könnte man so fortfahren: <code>of$Man.org=ifelse(of$Man == "org", 1, 0)</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(Hmisc)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">rcorr</span>(<span class="fu">as.matrix</span>(of[,<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">6</span>)]), <span class="at">type=</span><span class="st">"pearson"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Arab    SQ Man.con
Arab     1.00 -0.16    0.00
SQ      -0.16  1.00    0.13
Man.con  0.00  0.13    1.00

n= 36 


P
        Arab   SQ     Man.con
Arab           0.3495 0.9978 
SQ      0.3495        0.4609 
Man.con 0.9978 0.4609        </code></pre>
</div>
</div>
<p>Die <em>Pearson Korrelationskoeffizienten</em> sind alle &lt; 0,7 bzw. &gt;-0,7. Pearson Korrelationskoeffizienten nutzt man für lineare Zusammenhänge. Alternativ kann man die <em>Spearman Rang-Korrelation</em> nutzen, welche auf Rängen basiert und für monotone Zusammenhänge, i.e.&nbsp;monoton steigend oder fallend, eine Aussage trifft.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rcorr</span>(<span class="fu">as.matrix</span>(of[,<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">6</span>)]), <span class="at">type=</span><span class="st">"spearman"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>         Arab    SQ Man.con
Arab     1.00 -0.17    0.01
SQ      -0.17  1.00    0.11
Man.con  0.01  0.11    1.00

n= 36 


P
        Arab   SQ     Man.con
Arab           0.3172 0.9753 
SQ      0.3172        0.5142 
Man.con 0.9753 0.5142        </code></pre>
</div>
</div>
<p>Eine gute Möglichkeit zur Abbildung einer Korrelationsmatrix bietet die <code>library(corrplot)</code> mit der Funktion <code>corrplot()</code> und <code>corrplot.mixed()</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(corrplot)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot</span>(<span class="fu">cor</span>(of[,<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">6</span>)]), <span class="at">method =</span> <span class="st">"ellipse"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="06_StatMod_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="576"></p>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">corrplot.mixed</span>(<span class="fu">cor</span>(of[,<span class="fu">c</span>(<span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="dv">6</span>)]), <span class="at">upper =</span> <span class="st">"ellipse"</span>, <span class="at">tl.col =</span><span class="dv">1</span>, <span class="at">tl.cex=</span><span class="fl">0.75</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="06_StatMod_files/figure-html/unnamed-chunk-8-2.png" class="img-fluid" width="576"></p>
</div>
</div>
</section>
<section id="mit-dem-variance-inflation-factor-vif" class="level3">
<h3 class="anchored" data-anchor-id="mit-dem-variance-inflation-factor-vif">mit dem Variance Inflation Factor (VIF)</h3>
<p>Die potentielle Korrelation zwischen Erklärungsvariablen kann auch mit dem <em>Variance Inflation Factor</em> (VIF) getestet werden. Der VIF ist ein Maß für die Multikollineraität und gibt an, wie gut die einzelnen Erklärungsvariablen durch die anderen Erklärungsvariablen erklärt werden. Der VIF steht also für die Redundanz innerhalb der Erklärungsvariablen. Ich fitte ein Modell mit den Haupteffekten ohne Interaktionen. Solange alle VIFs &lt; 3 sind, ist alles in Ordnung. Es gibt auch Quellen, die &lt;5 oder gar &lt;10 angeben. Sollte ein VIF höher als dein gewähltes Kriterium sein, dann entfernst du schrittweise die Variable mit dem höchsten VIF, berechnest den VIF erneut und führst dies fort, bis alle Variablen unterhalb dem gewählten Kriterium sind.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(car)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Lade nötiges Paket: carData</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>
Attache Paket: 'car'</code></pre>
</div>
<div class="cell-output cell-output-stderr">
<pre><code>Das folgende Objekt ist maskiert 'package:dplyr':

    recode</code></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">vif</span>(<span class="fu">lm</span>(Weeds<span class="sc">~</span>Man<span class="sc">+</span>Arab<span class="sc">+</span>SQ, <span class="at">data=</span>of))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     Man     Arab       SQ 
1.016819 1.026933 1.043731 </code></pre>
</div>
</div>
<p>Alle Methoden führen zu dem Schluss, dass wir ein Modell mit allen drei Erklärungsvariablen formulieren können.</p>
</section>
</section>
<section id="modell-formulieren" class="level2">
<h2 class="anchored" data-anchor-id="modell-formulieren">Modell formulieren</h2>
<p>Ich fitte hier ein Modell inklusive Dreifachinteraktion, obwohl der Stichprobenumfang schon relativ klein ist und es auch Argumente dafür gibt, mit einem Modell nur mit Zweifachinteraktionen zu starten, i.e.&nbsp;ohne Dreifachinteraktion.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>mod<span class="ot">&lt;-</span><span class="fu">lm</span>(Weeds<span class="sc">~</span>Arab<span class="sc">*</span>Man<span class="sc">*</span>SQ, <span class="at">data=</span>of)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Weeds ~ Arab * Man * SQ, data = of)

Residuals:
      Min        1Q    Median        3Q       Max 
-0.271803 -0.100298  0.008768  0.093416  0.257560 

Coefficients:
                 Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)     3.748e+00  5.252e-01   7.136 9.15e-08 ***
Arab           -2.440e-02  7.899e-03  -3.090  0.00449 ** 
Manorg         -1.398e-01  7.234e-01  -0.193  0.84813    
SQ              3.181e-03  7.190e-03   0.442  0.66161    
Arab:Manorg     2.073e-02  1.121e-02   1.849  0.07505 .  
Arab:SQ        -3.852e-05  1.140e-04  -0.338  0.73805    
Manorg:SQ      -1.419e-03  1.070e-02  -0.133  0.89538    
Arab:Manorg:SQ -3.233e-05  1.695e-04  -0.191  0.85012    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.1554 on 28 degrees of freedom
Multiple R-squared:  0.956, Adjusted R-squared:  0.945 
F-statistic: 86.88 on 7 and 28 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="modellvereinfachung--selektion" class="level2">
<h2 class="anchored" data-anchor-id="modellvereinfachung--selektion">Modellvereinfachung, -selektion</h2>
<p>Wir werden nun verschiedene Methoden der Modell- und Variablenselektion kennenlernen.</p>
<section id="schrittweise-modellvereinfachung-mit-drop1-basierend-auf-teststatistik" class="level3">
<h3 class="anchored" data-anchor-id="schrittweise-modellvereinfachung-mit-drop1-basierend-auf-teststatistik">Schrittweise Modellvereinfachung mit drop1() basierend auf Teststatistik</h3>
<ul>
<li>Der klassische Weg: <em>backward selection</em></li>
<li>maximales Modell fitten</li>
<li>schrittweises Entfernen von nicht-signifikanten Interaktionen
<ul>
<li>dabei mit der Interaktion der höchsten Ordnung beginnen (Dreifach- vor Zweifach-Interaktionen)</li>
<li>höchster p-Wert</li>
<li>altes mit neuem Modell vergleichen (Fehler/deviance)</li>
</ul></li>
<li>Entfernen von nicht-signifikanten Erklärungsvariablen (Haupteffekte)
<ul>
<li>wenn nicht in signifikanter Interaktion enthalten</li>
</ul></li>
<li>Das minimale adäquate Modell enthält nur noch signifikante Parameter*.</li>
</ul>
<p>*nicht signifikante Haupteffekte sind im Modell möglich, wenn sie Teil einer signifikanten Interaktion sind</p>
<p>Wir testen mit der Funktion <code>drop1()</code> die Dreifachinteraktion.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(mod, <span class="at">test=</span><span class="st">"F"</span>) <span class="co"># Signifikanztest für Dreifachinteraktion</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Single term deletions

Model:
Weeds ~ Arab * Man * SQ
            Df  Sum of Sq     RSS     AIC F value Pr(&gt;F)
&lt;none&gt;                    0.67648 -127.08               
Arab:Man:SQ  1 0.00087887 0.67736 -129.03  0.0364 0.8501</code></pre>
</div>
</div>
<p>Der p-Wert ist größer 0.05. Also können wir die Dreifachinteraktion entfernen, indem ein neues Modell <code>mod1</code> durch die Funktion <code>update()</code> gefittet wird, welches alle Effekte wie <code>mod</code> besitzt <code>~.</code>, außer (daher das <code>-</code>) die Interaktion <code>Arab:Man:SQ</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>mod1<span class="ot">&lt;-</span><span class="fu">update</span>(mod, <span class="sc">~</span>.<span class="sc">-</span>Arab<span class="sc">:</span>Man<span class="sc">:</span>SQ) <span class="co"># Term wird aus Model entfernt </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wenn wir nun die Funktion <code>drop1()</code> für <code>mod1</code> nutzen, werden uns alle p-Werte für die Zweifachinteraktionen angezeigt.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(mod1, <span class="at">test=</span><span class="st">"F"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Single term deletions

Model:
Weeds ~ Arab + Man + SQ + Arab:Man + Arab:SQ + Man:SQ
         Df Sum of Sq     RSS      AIC F value    Pr(&gt;F)    
&lt;none&gt;                0.67736 -129.030                      
Arab:Man  1   1.48614 2.16351  -89.224 63.6264 8.501e-09 ***
Arab:SQ   1   0.00958 0.68695 -130.525  0.4103    0.5268    
Man:SQ    1   0.02171 0.69908 -129.894  0.9297    0.3429    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p><code>Arab:SQ</code> hat den höchsten p-Wert (und &gt; 0,05), also raus damit.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>mod2<span class="ot">&lt;-</span><span class="fu">update</span>(mod1, <span class="sc">~</span>.<span class="sc">-</span>Arab<span class="sc">:</span>SQ )</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(mod2, <span class="at">test=</span><span class="st">"F"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Single term deletions

Model:
Weeds ~ Arab + Man + SQ + Arab:Man + Man:SQ
         Df Sum of Sq     RSS      AIC F value    Pr(&gt;F)    
&lt;none&gt;                0.68695 -130.525                      
Arab:Man  1   1.59208 2.27903  -89.352 69.5286 2.628e-09 ***
Man:SQ    1   0.02135 0.70830 -131.423  0.9324     0.342    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p><code>Man:SQ</code> hat den höchsten p-Wert (und &gt; 0,05), also raus damit.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>mod3<span class="ot">&lt;-</span><span class="fu">update</span>(mod2, <span class="sc">~</span>.<span class="sc">-</span>Man<span class="sc">:</span>SQ)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(mod3, <span class="at">test=</span><span class="st">"F"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Single term deletions

Model:
Weeds ~ Arab + Man + SQ + Arab:Man
         Df Sum of Sq     RSS      AIC F value    Pr(&gt;F)    
&lt;none&gt;                0.70830 -131.423                      
SQ        1   0.00188 0.71018 -133.327  0.0824     0.776    
Arab:Man  1   1.66223 2.37052  -89.935 72.7506 1.238e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>Der p-Wert für <code>SQ</code> als Haupteffekt erscheint, weil <code>SQ</code> nicht mehr in einer Interaktion enthalten ist. <code>SQ</code> hat den höchsten p-Wert (und &gt; 0,05), also raus damit.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>mod4<span class="ot">&lt;-</span><span class="fu">update</span>(mod3, <span class="sc">~</span>.<span class="sc">-</span>SQ)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">drop1</span>(mod4, <span class="at">test=</span><span class="st">"F"</span>) <span class="co"># </span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Single term deletions

Model:
Weeds ~ Arab + Man + Arab:Man
         Df Sum of Sq     RSS     AIC F value   Pr(&gt;F)    
&lt;none&gt;                0.71018 -133.33                     
Arab:Man  1    1.7458 2.45599  -90.66  78.665 3.92e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</code></pre>
</div>
</div>
<p>p &lt; 0,05, wir sollten keine weitere Variable entfernen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Weeds ~ Arab + Man + Arab:Man, data = of)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.27082 -0.12469  0.01851  0.09372  0.25381 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  3.983767   0.097888  40.697  &lt; 2e-16 ***
Arab        -0.027254   0.001525 -17.868  &lt; 2e-16 ***
Manorg      -0.263862   0.137806  -1.915   0.0645 .  
Arab:Manorg  0.019036   0.002146   8.869 3.92e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.149 on 32 degrees of freedom
Multiple R-squared:  0.9538,    Adjusted R-squared:  0.9495 
F-statistic: 220.2 on 3 and 32 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Analog gibt es auch eine Funktion <code>add1()</code> bei der eine <em>forward selection</em> durchgeführt werden kann.<br>
Sowohl die klassische <em>backward</em> also auch die <em>forward selection</em> sind für Modelle mit wenigen Erklärungsvariablen denkbar.</p>
</section>
<section id="übung-6.1." class="level3">
<h3 class="anchored" data-anchor-id="übung-6.1.">Übung 6.1.</h3>
<p>Die Aktivität von Lurchen wurde in den drei Habitattypen (Teichumgebung, Hecke und Wald) bei unterschiedlichen Witterungsbedingungen (Temperatur und Luftfeuchte) gemessen.</p>
<ul>
<li><p>Importiere die Daten <a href="https://github.com/DoreenGabriel/Kurs/blob/main/Themen/06/Lurche.xlsx" target="_blank">Lurche.xlsx</a> und mach dich mit den Daten vertraut.</p></li>
<li><p>Modelliere die Aktivität der Lurche mit einer backward selektion.</p></li>
</ul>
</section>
</section>
<section id="modellselektion-basierend-auf-informationskriterien" class="level2">
<h2 class="anchored" data-anchor-id="modellselektion-basierend-auf-informationskriterien">Modellselektion basierend auf Informationskriterien</h2>
<p>Wenn wir jedoch eine Vielzahl an Erklärungsvariablen haben und damit eine Vielzahl an potentiellen Erklärungsmodellen, führt eine schrittweise Vereinfachung zu vielen aufeinanderfolgenden Signifikanztests. Die durchgeführten Signifikanztests sind nicht voneinander unabhängig. Das Problem des multiplen Testens tritt auf. Der p-Wert verliert seine eigentliche Bedeutung und müsste um die Anzahl der Tests korrigiert werden. Daher steht diese Vorgehensweise bei vielen Anwendern in der Kritik.</p>
<p>Besser ist es, die Modell- bzw. Variablenselektion basierend auf Informationskriterien durchzuführen.</p>
<p>Informationskriterien wägen für uns zwischen der Anpassungsgüte (<em>fit</em>) und der Komplexität (Anzahl Parameter <em>k</em>) des Modells ab:</p>
<ul>
<li>Das Akaikes Informationskriterium (<em>Akaike Information Criterion</em> - AIC) berechnet sich aus der Log-Likelihood und der Anzahl Modellparameter.<br>
</li>
<li>Das korrigierte Akaikes Informationskriterium (AICc) bestraft stärker um die Anzahl der Modellparameter, wenn der Stichprobenumfang klein ist und verhindert damit stärker den Overfit als AIC. <strong>Daumenregel</strong>: Nutze AICc wenn das Verhältnis aus Stichprobenumfang (n) zu Anzahl Modellparameter (k) n/k &lt; 40 ist.<br>
</li>
<li>Bayessches Informationskriterium (<em>Bayesian Information Criterion</em> - BIC) berücksichtigt neben Log-likelihood und Anzahl Modellparametern auch den Stichprobenumfang.</li>
</ul>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Wichtig
</div>
</div>
<div class="callout-body-container callout-body">
<p>Je niedriger der AIC (AICc, BIC), desto besser das Modell. Es zählt nicht der absolute Wert (z.B. AIC = 100 ist unwichtig).</p>
</div>
</div>
<p>Beispiel:</p>
<table class="table">
<thead>
<tr class="header">
<th>Modell</th>
<th>AIC</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Modell 1</td>
<td>100</td>
</tr>
<tr class="even">
<td>Modell 2</td>
<td>98.8</td>
</tr>
<tr class="odd">
<td>Modell 3</td>
<td>108</td>
</tr>
</tbody>
</table>
<p>Damit wäre Modell 2 das bessere Modell.</p>
<p>Während die absoluten AIC-Werte also keine Bedeutung haben, können die delta AIC-Werte genutzt werden, um das <em>Level of Empirical Support</em> des jeweiligen Modells einzuordnen. Burnham und Anderson (2002) <em>Model Selection and Multimodel Inference</em> Seite 170 geben folgende Kennwerte an:</p>
<table class="table">
<thead>
<tr class="header">
<th>delta AIC</th>
<th><em>Level of Empirical Support</em></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0-2</td>
<td>substantial</td>
</tr>
<tr class="even">
<td>4-7</td>
<td>considerably less</td>
</tr>
<tr class="odd">
<td>&gt; 10</td>
<td>none</td>
</tr>
</tbody>
</table>
<p>Entsprechend wären Modell 2 und Modell 1 von Bedeutung, während Modell 3 keine Berücksichtigung erfahren muss.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Wichtig
</div>
</div>
<div class="callout-body-container callout-body">
<p>Es können nur Modelle verglichen werden, die auf den gleichen Datensatz (i.e.&nbsp;gleiche Abhängige y) gefittet wurden.</p>
</div>
</div>
<p>Von einem Vergleich von Modellen, die mit verschiedenen R-Packages gefitted wurden, würde ich abraten.</p>
<p>Auch negative AIC-Werte können auftreten. Auch hier gilt, je kleiner desto besser.</p>
</section>
<section id="schrittweise-verfahren-basierend-auf-aic-mit-step" class="level2">
<h2 class="anchored" data-anchor-id="schrittweise-verfahren-basierend-auf-aic-mit-step">Schrittweise Verfahren basierend auf AIC mit step()</h2>
<p>Mit der Funktion <code>step()</code> kann eine Modellselektion automatisiert auf Basis des AIC erfolgen. Hier ein Beispiel für eine Rückwärtsselektion, bei dem ausgehend vom vollen Modell schrittweise Erklärungsvariablen entfernt werden und die daraus resultierenden Modelle via AIC verglichen werden. Diese Prozedur stoppt, wenn beim Entfernen der Variablen der AIC (wieder) ansteigen würde.</p>
<section id="step-backward" class="level3">
<h3 class="anchored" data-anchor-id="step-backward">step backward</h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>mod.b<span class="ot">&lt;-</span><span class="fu">step</span>(mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=-127.08
Weeds ~ Arab * Man * SQ

              Df  Sum of Sq     RSS     AIC
- Arab:Man:SQ  1 0.00087887 0.67736 -129.03
&lt;none&gt;                      0.67648 -127.08

Step:  AIC=-129.03
Weeds ~ Arab + Man + SQ + Arab:Man + Arab:SQ + Man:SQ

           Df Sum of Sq     RSS      AIC
- Arab:SQ   1   0.00958 0.68695 -130.525
- Man:SQ    1   0.02171 0.69908 -129.894
&lt;none&gt;                  0.67736 -129.030
- Arab:Man  1   1.48614 2.16351  -89.224

Step:  AIC=-130.52
Weeds ~ Arab + Man + SQ + Arab:Man + Man:SQ

           Df Sum of Sq     RSS      AIC
- Man:SQ    1   0.02135 0.70830 -131.423
&lt;none&gt;                  0.68695 -130.525
- Arab:Man  1   1.59208 2.27903  -89.352

Step:  AIC=-131.42
Weeds ~ Arab + Man + SQ + Arab:Man

           Df Sum of Sq     RSS      AIC
- SQ        1   0.00188 0.71018 -133.327
&lt;none&gt;                  0.70830 -131.423
- Arab:Man  1   1.66223 2.37052  -89.935

Step:  AIC=-133.33
Weeds ~ Arab + Man + Arab:Man

           Df Sum of Sq     RSS     AIC
&lt;none&gt;                  0.71018 -133.33
- Arab:Man  1    1.7458 2.45599  -90.66</code></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod.b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Weeds ~ Arab + Man + Arab:Man, data = of)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.27082 -0.12469  0.01851  0.09372  0.25381 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  3.983767   0.097888  40.697  &lt; 2e-16 ***
Arab        -0.027254   0.001525 -17.868  &lt; 2e-16 ***
Manorg      -0.263862   0.137806  -1.915   0.0645 .  
Arab:Manorg  0.019036   0.002146   8.869 3.92e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.149 on 32 degrees of freedom
Multiple R-squared:  0.9538,    Adjusted R-squared:  0.9495 
F-statistic: 220.2 on 3 and 32 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="step-forward" class="level3">
<h3 class="anchored" data-anchor-id="step-forward">step forward</h3>
<p>Beim Vorwärtsverfahren müssen wir zunächst das Null-Modell fitten</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>mod0<span class="ot">&lt;-</span><span class="fu">lm</span>(Weeds<span class="sc">~</span><span class="dv">1</span>, <span class="at">data=</span>of) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>und dann die Argumente <code>scope</code> und <code>direction</code> bedienen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>mod.fw<span class="ot">=</span><span class="fu">step</span>(mod0, <span class="at">scope=</span><span class="fu">list</span>(<span class="at">lower=</span>mod0, <span class="at">upper=</span>mod), <span class="at">direction=</span><span class="st">"forward"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=-28.64
Weeds ~ 1

       Df Sum of Sq     RSS     AIC
+ Man   1    6.9169  8.4531 -48.164
+ Arab  1    6.0033  9.3667 -44.469
&lt;none&gt;              15.3700 -28.640
+ SQ    1    0.1196 15.2504 -26.921

Step:  AIC=-48.16
Weeds ~ Man

       Df Sum of Sq    RSS     AIC
+ Arab  1    5.9971 2.4560 -90.660
+ SQ    1    0.4693 7.9838 -48.220
&lt;none&gt;              8.4531 -48.164

Step:  AIC=-90.66
Weeds ~ Man + Arab

           Df Sum of Sq     RSS      AIC
+ Arab:Man  1   1.74581 0.71018 -133.327
&lt;none&gt;                  2.45599  -90.660
+ SQ        1   0.08547 2.37052  -89.935

Step:  AIC=-133.33
Weeds ~ Man + Arab + Man:Arab

       Df Sum of Sq     RSS     AIC
&lt;none&gt;              0.71018 -133.33
+ SQ    1  0.001882 0.70830 -131.42</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod.fw)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Weeds ~ Man + Arab + Man:Arab, data = of)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.27082 -0.12469  0.01851  0.09372  0.25381 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  3.983767   0.097888  40.697  &lt; 2e-16 ***
Manorg      -0.263862   0.137806  -1.915   0.0645 .  
Arab        -0.027254   0.001525 -17.868  &lt; 2e-16 ***
Manorg:Arab  0.019036   0.002146   8.869 3.92e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.149 on 32 degrees of freedom
Multiple R-squared:  0.9538,    Adjusted R-squared:  0.9495 
F-statistic: 220.2 on 3 and 32 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="step-both" class="level3">
<h3 class="anchored" data-anchor-id="step-both">step both</h3>
<p>Mit dem Argument <code>direction="both"</code> wird die Vorwärts- und Rückwärtsselektion kombiniert.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>mod.both<span class="ot">=</span><span class="fu">step</span>(mod0, <span class="at">scope=</span><span class="fu">list</span>(<span class="at">upper=</span>mod), <span class="at">direction=</span><span class="st">"both"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=-28.64
Weeds ~ 1

       Df Sum of Sq     RSS     AIC
+ Man   1    6.9169  8.4531 -48.164
+ Arab  1    6.0033  9.3667 -44.469
&lt;none&gt;              15.3700 -28.640
+ SQ    1    0.1196 15.2504 -26.921

Step:  AIC=-48.16
Weeds ~ Man

       Df Sum of Sq     RSS     AIC
+ Arab  1    5.9971  2.4560 -90.660
+ SQ    1    0.4693  7.9838 -48.220
&lt;none&gt;               8.4531 -48.164
- Man   1    6.9169 15.3700 -28.640

Step:  AIC=-90.66
Weeds ~ Man + Arab

           Df Sum of Sq    RSS      AIC
+ Arab:Man  1    1.7458 0.7102 -133.327
&lt;none&gt;                  2.4560  -90.660
+ SQ        1    0.0855 2.3705  -89.935
- Arab      1    5.9971 8.4531  -48.164
- Man       1    6.9107 9.3667  -44.469

Step:  AIC=-133.33
Weeds ~ Man + Arab + Man:Arab

           Df Sum of Sq     RSS     AIC
&lt;none&gt;                  0.71018 -133.33
+ SQ        1   0.00188 0.70830 -131.42
- Man:Arab  1   1.74581 2.45599  -90.66</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod.both)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Weeds ~ Man + Arab + Man:Arab, data = of)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.27082 -0.12469  0.01851  0.09372  0.25381 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  3.983767   0.097888  40.697  &lt; 2e-16 ***
Manorg      -0.263862   0.137806  -1.915   0.0645 .  
Arab        -0.027254   0.001525 -17.868  &lt; 2e-16 ***
Manorg:Arab  0.019036   0.002146   8.869 3.92e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.149 on 32 degrees of freedom
Multiple R-squared:  0.9538,    Adjusted R-squared:  0.9495 
F-statistic: 220.2 on 3 and 32 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Alle drei Verfahren haben zum gleichen besten Modell geführt. Das ist nicht immer so. Zusätzlich wird mit der Funktion <code>step()</code> immer nur <strong>ein</strong> bestes Modell selektiert und es bleibt offen, ob es noch andere ähnlich gute Modelle gibt.</p>
</section>
<section id="übung-6.2." class="level3">
<h3 class="anchored" data-anchor-id="übung-6.2.">Übung 6.2.</h3>
<ul>
<li>Modelliere die Aktivität der Lurche mit der step-Funktion.</li>
</ul>
</section>
</section>
<section id="modellvergleiche-basierend-auf-aic-mit-dregde" class="level2">
<h2 class="anchored" data-anchor-id="modellvergleiche-basierend-auf-aic-mit-dregde">Modellvergleiche basierend auf AIC mit dregde()</h2>
<p>Mit der Funktion <code>dredge()</code> aus dem Paket <code>MuMIn</code> können verschiedene <em>candidate models</em> (i.e.&nbsp;alle Kombinationsmöglichkeiten zwischen den Erklärungsvariablen) anhand eines Informationskriteriums z.B. <code>rank = "AICc"</code> verglichen werden. Weitere Informationskriterien werden über das Argument <code>extra = alist(AICc, AIC, BIC, Cp, "R^2")</code> berechnet. Zudem wird auch das Akaike Gewicht (<code>weight</code>) angegeben, welches eine relatives Maß für die <em>Wahrscheinlichkeit</em> (englisch: <em>rate of support or evidence</em>) ist, dass das jeweilige Modell das bessere unter den <em>candidate models</em> ist. Im Allgemeinen haben Modelle innerhalb von delta AIC &lt; 2 einen ähnlich guten <em>support</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MuMIn)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>dd<span class="ot">=</span><span class="fu">dredge</span>(mod)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in dredge(mod): 'global.model''s 'na.action' argument is not set and options('na.action') is "na.omit"</code></pre>
</div>
</div>
<p>Wir müssen im globalen Modell <code>mod</code> das Argument <code>na.action</code> = <code>na.fail</code> setzen oder die R-Optionen mit <code>options(na.action = "na.fail")</code> verändern.</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Wichtig
</div>
</div>
<div class="callout-body-container callout-body">
<p>Es dürfen keine <em>missing values (NA)</em> sowohl in der Abhängigen als auch in den Erklärungsvariablen vorkommen. Nutze ggfls. die Funktion <code>complete.cases()</code>.</p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>mod<span class="ot">&lt;-</span><span class="fu">lm</span>(Weeds<span class="sc">~</span>Arab<span class="sc">*</span>Man<span class="sc">*</span>SQ, <span class="at">data=</span>of, <span class="at">na.action=</span>na.fail)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>dd<span class="ot">=</span><span class="fu">dredge</span>(mod, <span class="at">rank =</span> <span class="st">"AICc"</span>, <span class="at">extra =</span> <span class="fu">alist</span>(AICc, AIC, BIC, <span class="st">"R^2"</span>)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>Fixed term is "(Intercept)"</code></pre>
</div>
</div>
<p>Mit dem Argument <code>m.lim=c(0,4)</code> kann man die Anzahl der Parameter beschränken, z.B. auf minimal 0 und maximal 4 Parameter. Die obige Funktion würde dann so aussehen: <code>dredge(mod, rank = "AICc", extra = alist(AICc, AIC, BIC, "R^2"), m.lim=c(0,4))</code>. Da wir aber ein recht überschaubares Modell haben, ist dies nicht nötig.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>dd</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Global model call: lm(formula = Weeds ~ Arab * Man * SQ, data = of, na.action = na.fail)
---
Model selection table 
    (Int)       Arb Man         SQ Arb:Man     Arb:SQ Man:SQ Arb:Man:SQ   AICc
12  3.984 -0.027250   +                  +                              -27.16
16  4.025 -0.027390   + -0.0004843       +                              -24.36
48  3.910 -0.027010   +  0.0008750       +                 +            -22.36
32  3.807 -0.023870   +  0.0026240       + -5.212e-05                   -21.73
64  3.687 -0.023420   +  0.0040560       + -5.315e-05      +            -19.53
128 3.748 -0.024400   +  0.0031810       + -3.852e-05      +          + -15.99
4   3.408 -0.017640   +                                                  14.79
8   3.173 -0.017290   +  0.0031580                                       16.23
24  2.453 -0.005464   +  0.0138700         -1.828e-04                    17.29
40  2.961 -0.016800   +  0.0058460                         +             17.71
56  2.251 -0.005091   +  0.0164200         -1.810e-04      +             18.94
3   2.351             +                                                  56.75
39  1.399             +  0.0140300                         +             56.85
7   1.856             +  0.0073020                                       57.23
2   3.847 -0.017650                                                      60.44
6   3.884 -0.017710     -0.0005160                                       62.98
22  4.612 -0.030090     -0.0116100          1.917e-04                    65.15
1   2.789                                                                75.89
5   2.549                0.0036570                                       77.99
       AIC     BIC      R^2 df  logLik   AICc  delta weight
12  -29.16 -21.250 0.953800  5  19.582 -27.16   0.00  0.700
16  -27.26 -17.760 0.953900  6  19.630 -24.36   2.80  0.172
48  -26.36 -15.280 0.955300  7  20.181 -22.36   4.80  0.063
32  -25.73 -14.650 0.954500  7  19.865 -21.73   5.43  0.046
64  -24.87 -12.200 0.955900  8  20.433 -19.53   7.63  0.015
128 -22.91  -8.662 0.956000  9  20.457 -15.99  11.17  0.003
4    13.50  19.840 0.840200  4  -2.752  14.79  41.96  0.000
8    14.23  22.150 0.845800  5  -2.114  16.23  43.39  0.000
24   14.39  23.900 0.853400  6  -1.197  17.29  44.45  0.000
40   14.81  24.310 0.851700  6  -1.406  17.71  44.87  0.000
56   14.94  26.020 0.859200  7  -0.470  18.94  46.10  0.000
3    56.00  60.750 0.450000  3 -25.000  56.75  83.91  0.000
39   54.85  62.770 0.523400  5 -22.424  56.85  84.01  0.000
7    55.94  62.280 0.480600  4 -23.972  57.23  84.40  0.000
2    59.69  64.450 0.390600  3 -26.847  60.44  87.61  0.000
6    61.69  68.020 0.390700  4 -26.843  62.98  90.14  0.000
22   63.15  71.060 0.399800  5 -26.573  65.15  92.31  0.000
1    75.52  78.690 0.000000  2 -35.762  75.89 103.05  0.000
5    77.24  81.990 0.007784  3 -35.621  77.99 105.16  0.000
Models ranked by AICc(x) </code></pre>
</div>
</div>
<p>Wurden sehr viele Modelle gefittet, kann man mit dem folgenden Befehl die Top 5 sehen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>dd[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]<span class="co"># die besten 5 Modelle nach AICc</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Global model call: lm(formula = Weeds ~ Arab * Man * SQ, data = of, na.action = na.fail)
---
Model selection table 
   (Int)      Arb Man         SQ Arb:Man     Arb:SQ Man:SQ   AICc    AIC    BIC
12 3.984 -0.02725   +                  +                   -27.16 -29.16 -21.25
16 4.025 -0.02739   + -0.0004843       +                   -24.36 -27.26 -17.76
48 3.910 -0.02701   +  0.0008750       +                 + -22.36 -26.36 -15.28
32 3.807 -0.02387   +  0.0026240       + -5.212e-05        -21.73 -25.73 -14.65
64 3.687 -0.02342   +  0.0040560       + -5.315e-05      + -19.53 -24.87 -12.20
      R^2 df logLik   AICc delta weight
12 0.9538  5 19.582 -27.16  0.00  0.702
16 0.9539  6 19.630 -24.36  2.80  0.173
48 0.9553  7 20.181 -22.36  4.80  0.064
32 0.9545  7 19.865 -21.73  5.43  0.046
64 0.9559  8 20.433 -19.53  7.63  0.015
Models ranked by AICc(x) </code></pre>
</div>
</div>
<p>Der Output zeigt uns</p>
<ul>
<li>das Modell</li>
<li>die Modellparameter: (Int) für Intercept, Arb, Man, SQ, Arb:Ma, Arb:SQ, und Man:SQ
<ul>
<li>wobei für Faktoren nur ein + angezeigt wird, wenn diese im Modell enthalten sind</li>
<li>für kontinuierliche Erklärungsvariablen wird der geschätzte Koeffizient angezeigt</li>
</ul></li>
<li>die Informationskriterien: AICc, AIC, BIC, R²</li>
<li>die degree of freedoms und die Log-Likelihood</li>
<li>das Informationskriterium, welches zum Vergleich der Modelle genutzt wurde (hier AICc)</li>
<li>das daraus berechnete delta (hier delta AICc)</li>
<li>das Akaike weight, welches alle <code>candidate models</code> vergleicht (die Summe ergibt 1) und damit ein Maß für <em>relative</em> Güte der Modelle ist.</li>
</ul>
<p>Mit der Funktion <code>subset()</code> werden die Top-Modelle innerhalb delta AICc &lt; 4 (oder &lt;2) angezeigt.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">subset</span>(dd, delta <span class="sc">&lt;</span> <span class="dv">4</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Global model call: lm(formula = Weeds ~ Arab * Man * SQ, data = of, na.action = na.fail)
---
Model selection table 
   (Int)      Arb Man         SQ Arb:Man   AICc    AIC    BIC    R^2 df logLik
12 3.984 -0.02725   +                  + -27.16 -29.16 -21.25 0.9538  5 19.582
16 4.025 -0.02739   + -0.0004843       + -24.36 -27.26 -17.76 0.9539  6 19.630
     AICc delta weight
12 -27.16   0.0  0.802
16 -24.36   2.8  0.198
Models ranked by AICc(x) </code></pre>
</div>
</div>
<p>Zur Präsentation der Ergebnisse würde man zur obigen Tabelle noch das <strong>globale Modell</strong> und das <strong>Nullmodell</strong> hinzufügen.</p>
<p>Das beste Modell mit dem niedrigsten AICc ist wieder:<br>
<code>Weeds ~ Arab + Man + Arab:Man</code></p>
<p>Wir können auf das beste Model mit der Funktion <code>get.models()</code> zugreifen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(<span class="fu">get.models</span>(dd, <span class="dv">1</span>)[[<span class="dv">1</span>]])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Weeds ~ Arab + Man + Arab:Man + 1, data = of, na.action = na.fail)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.27082 -0.12469  0.01851  0.09372  0.25381 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  3.983767   0.097888  40.697  &lt; 2e-16 ***
Arab        -0.027254   0.001525 -17.868  &lt; 2e-16 ***
Manorg      -0.263862   0.137806  -1.915   0.0645 .  
Arab:Manorg  0.019036   0.002146   8.869 3.92e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.149 on 32 degrees of freedom
Multiple R-squared:  0.9538,    Adjusted R-squared:  0.9495 
F-statistic: 220.2 on 3 and 32 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>mod.dd<span class="ot">=</span><span class="fu">get.models</span>(dd, <span class="dv">1</span>)[[<span class="dv">1</span>]]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Die Bedeutung der Erklärungsvariablen (<em>Importance</em>) kann durch das <em>sum of Akaike weight</em> berechnet werden, indem für alle Variablen die Akaike Gewichte der Modelle aufsummiert werden, in denen die Variable enthalten ist. Die entsprechenden <em>sum of Akaike weights</em> variieren dann zwischen 1 (wichtig) und 0 (unwichtig).</p>
<p>Mit der Funktion <code>sw()</code> wird das <em>sum of Akaike weight</em> über alle Modelle berechnet:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sw</span>(dd)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     Arab  Man   Arab:Man SQ    Man:SQ Arab:SQ Arab:Man:SQ
Sum of weights:          1     1     1      0.3  0.08   0.06   &lt;0.01      
N containing models:    14    14     6       14     6      6       1      </code></pre>
</div>
</div>
<p>Mit dem Argument <code>subset</code> wird das <em>sum of Akaike weight</em> über alle Modelle innerhalb delta AICc &lt; 4 berechnet:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sw</span>(<span class="fu">subset</span>(dd, delta <span class="sc">&lt;=</span> <span class="dv">4</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     Arab Man Arab:Man SQ 
Sum of weights:      1.0  1.0 1.0      0.2
N containing models:   2    2   2        1</code></pre>
</div>
</div>
<p>Burnham and Anderson (2002) empfehlen die erste Methode.</p>
</section>
<section id="modellvergleiche-basierend-auf-aic-mit-eigenem-set-an-candidate-models" class="level2">
<h2 class="anchored" data-anchor-id="modellvergleiche-basierend-auf-aic-mit-eigenem-set-an-candidate-models">Modellvergleiche basierend auf AIC mit eigenem Set an Candidate Models</h2>
<p>Wenn man ein sehr komplexes globales Modell mit vielen Erklärungsvariablen und Interaktionen hat, kann das zu sehr vielen <em>candidate models</em> führen. Das wird dann auch gerne als <em>“fishing”</em> bezeichnet und wird ebenso wenig gern gesehen. Daher empfehlen Burnham und Anderson (2002) <em>a priori</em> ein Set an <em>candidate models</em> zu erstellen und diese zu vergleichen.</p>
<p>Auch hierfür kann das Packet <code>MuMIn</code> genutzt werden.</p>
<p>Beispiel angepasst aus: <a href="https://sites.google.com/site/rforfishandwildlifegrads/home/mumin_usage_examples" target="_blank">https://sites.google.com/site/rforfishandwildlifegrads/home/mumin_usage_examples</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MuMIn)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="fu">options</span>(<span class="at">na.action =</span> <span class="st">"na.fail"</span>) <span class="co"># wir ändern die globalen Optionen</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wir erstellen das globale Modell <code>mod</code> und verschiedene <em>candidate models</em> <code>mod1</code> bis <code>mod11</code> und das Nullmodell <code>mod0</code>. Natürlich können nur Modelle als “beste” Modelle identifiziert werden, wenn sie vorher auch gefittet wurden. Daher ist die Wahl der geeigneten <em>candidate models</em> die größte wissenschaftliche Herausforderung.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>mod<span class="ot">&lt;-</span><span class="fu">lm</span>(Weeds<span class="sc">~</span>Arab<span class="sc">*</span>Man<span class="sc">*</span>SQ, <span class="at">data=</span>of)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>mod1<span class="ot">&lt;-</span><span class="fu">lm</span>(Weeds<span class="sc">~</span>Arab<span class="sc">*</span>Man<span class="sc">+</span>SQ, <span class="at">data=</span>of)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>mod2<span class="ot">&lt;-</span><span class="fu">lm</span>(Weeds<span class="sc">~</span>Arab<span class="sc">+</span>Man<span class="sc">*</span>SQ, <span class="at">data=</span>of)</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>mod3<span class="ot">&lt;-</span><span class="fu">lm</span>(Weeds<span class="sc">~</span>Arab<span class="sc">*</span>SQ<span class="sc">+</span>Man, <span class="at">data=</span>of)</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>mod4<span class="ot">&lt;-</span><span class="fu">lm</span>(Weeds<span class="sc">~</span>Arab<span class="sc">*</span>Man, <span class="at">data=</span>of)</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>mod5<span class="ot">&lt;-</span><span class="fu">lm</span>(Weeds<span class="sc">~</span>Man<span class="sc">*</span>SQ, <span class="at">data=</span>of)</span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>mod6<span class="ot">&lt;-</span><span class="fu">lm</span>(Weeds<span class="sc">~</span>Arab<span class="sc">*</span>SQ, <span class="at">data=</span>of)</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a>mod7<span class="ot">&lt;-</span><span class="fu">lm</span>(Weeds<span class="sc">~</span>Arab<span class="sc">+</span>Man, <span class="at">data=</span>of)</span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>mod8<span class="ot">&lt;-</span><span class="fu">lm</span>(Weeds<span class="sc">~</span>Man<span class="sc">+</span>SQ, <span class="at">data=</span>of)</span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>mod9<span class="ot">&lt;-</span><span class="fu">lm</span>(Weeds<span class="sc">~</span>Arab<span class="sc">+</span>SQ, <span class="at">data=</span>of)</span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>mod10<span class="ot">&lt;-</span><span class="fu">lm</span>(Weeds<span class="sc">~</span>Arab<span class="sc">+</span>Man<span class="sc">+</span>SQ, <span class="at">data=</span>of)</span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>mod0<span class="ot">&lt;-</span><span class="fu">lm</span>(Weeds<span class="sc">~</span><span class="dv">1</span>, <span class="at">data=</span>of)</span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a>mod11<span class="ot">&lt;-</span><span class="fu">lm</span>(Weeds<span class="sc">~</span>(Arab<span class="sc">+</span>Man<span class="sc">+</span>SQ)<span class="sc">^</span><span class="dv">2</span>, <span class="at">data=</span>of)<span class="co"># ist das gleiche wie Arab*Man+Arab*SQ+Man*SQ</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wir nutzen die Funktion <code>mod.sel()</code>, um für alle Modelle das AICc, delta AICc und das <em>Akaike weight</em> zu berechnen und ins Objekt <code>out.put</code> zu schreiben.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>out.put<span class="ot">&lt;-</span><span class="fu">model.sel</span>(mod1,mod2,mod3,mod4,mod5,mod6,mod7,mod8,mod9,mod10,mod11, mod,mod0)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>out.put </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model selection table 
      (Int)       Arb Man         SQ Arb:Man Man:SQ     Arb:SQ Arb:Man:SQ df
mod4  3.984 -0.027250   +                  +                               5
mod1  4.025 -0.027390   + -0.0004843       +                               6
mod11 3.687 -0.023420   +  0.0040560       +      + -5.315e-05             8
mod   3.748 -0.024400   +  0.0031810       +      + -3.852e-05          +  9
mod7  3.408 -0.017640   +                                                  4
mod10 3.173 -0.017290   +  0.0031580                                       5
mod3  2.453 -0.005464   +  0.0138700                -1.828e-04             6
mod2  2.961 -0.016800   +  0.0058460              +                        6
mod5  1.399             +  0.0140300              +                        5
mod8  1.856             +  0.0073020                                       4
mod9  3.884 -0.017710     -0.0005160                                       4
mod6  4.612 -0.030090     -0.0116100                 1.917e-04             5
mod0  2.789                                                                2
       logLik  AICc  delta weight
mod4   19.582 -27.2   0.00  0.786
mod1   19.630 -24.4   2.80  0.194
mod11  20.433 -19.5   7.63  0.017
mod    20.457 -16.0  11.17  0.003
mod7   -2.752  14.8  41.96  0.000
mod10  -2.114  16.2  43.39  0.000
mod3   -1.197  17.3  44.45  0.000
mod2   -1.406  17.7  44.87  0.000
mod5  -22.424  56.8  84.01  0.000
mod8  -23.972  57.2  84.40  0.000
mod9  -26.843  63.0  90.14  0.000
mod6  -26.573  65.1  92.31  0.000
mod0  -35.762  75.9 103.05  0.000
Models ranked by AICc(x) </code></pre>
</div>
</div>
<p>Mit dem Argument <code>rank</code> können wir auch ein anderes Informationskriterium wählen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>out.put2<span class="ot">&lt;-</span><span class="fu">model.sel</span>(mod1,mod2,mod3,mod4,mod5,mod6,mod7,mod8,mod9,mod10,mod11, mod,mod0, <span class="at">rank=</span><span class="st">"AIC"</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>out.put2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Model selection table 
      (Int)       Arb Man         SQ Arb:Man Man:SQ     Arb:SQ Arb:Man:SQ df
mod4  3.984 -0.027250   +                  +                               5
mod1  4.025 -0.027390   + -0.0004843       +                               6
mod11 3.687 -0.023420   +  0.0040560       +      + -5.315e-05             8
mod   3.748 -0.024400   +  0.0031810       +      + -3.852e-05          +  9
mod7  3.408 -0.017640   +                                                  4
mod10 3.173 -0.017290   +  0.0031580                                       5
mod3  2.453 -0.005464   +  0.0138700                -1.828e-04             6
mod2  2.961 -0.016800   +  0.0058460              +                        6
mod5  1.399             +  0.0140300              +                        5
mod8  1.856             +  0.0073020                                       4
mod9  3.884 -0.017710     -0.0005160                                       4
mod6  4.612 -0.030090     -0.0116100                 1.917e-04             5
mod0  2.789                                                                2
       logLik   AIC  delta weight
mod4   19.582 -29.2   0.00  0.647
mod1   19.630 -27.3   1.90  0.250
mod11  20.433 -24.9   4.30  0.075
mod    20.457 -22.9   6.25  0.028
mod7   -2.752  13.5  42.67  0.000
mod10  -2.114  14.2  43.39  0.000
mod3   -1.197  14.4  43.56  0.000
mod2   -1.406  14.8  43.98  0.000
mod5  -22.424  54.8  84.01  0.000
mod8  -23.972  55.9  85.11  0.000
mod9  -26.843  61.7  90.85  0.000
mod6  -26.573  63.1  92.31  0.000
mod0  -35.762  75.5 104.69  0.000
Models ranked by AIC(x) </code></pre>
</div>
</div>
<p>Wir erstellen nun eine Tabelle mit den Informationskriterien und den Erklärungsvariablen der Modelle.<br>
Die <code>[c(9,11:13)]</code> greifen auf 4 Spalten zu und müssen bei anderen Beispielen entsprechend der Anzahl Spalten (i.e.&nbsp;Erklärungsvariablen) ggfls. angepasst werden.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>sel.table<span class="ot">&lt;-</span><span class="fu">as.data.frame</span>(out.put)[<span class="fu">c</span>(<span class="dv">9</span>,<span class="dv">11</span><span class="sc">:</span><span class="dv">13</span>)]</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>sel.table </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      df      AICc      delta       weight
mod4   5 -27.16372   0.000000 7.860065e-01
mod1   6 -24.36270   2.801024 1.937276e-01
mod11  8 -19.53353   7.630191 1.732013e-02
mod    9 -15.99053  11.173195 2.945762e-03
mod7   4  14.79426  41.957989 6.086458e-10
mod10  5  16.22886  43.392586 2.970611e-10
mod3   6  17.29047  44.454197 1.747108e-10
mod2   6  17.70841  44.872130 1.417643e-10
mod5   5  56.84831  84.012037 4.492046e-19
mod8   4  57.23396  84.397687 3.704258e-19
mod9   4  62.97609  90.139816 2.098040e-20
mod6   5  65.14594  92.309661 7.089866e-21
mod0   2  75.88754 103.051259 3.297080e-23</code></pre>
</div>
</div>
<p>Zur besseren Lesbarkeit runden wir die Spalten 2 und 3 auf 1 Kommastelle und Spalten 4 auf 2 Kommastellen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>sel.table[,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>]<span class="ot">&lt;-</span> <span class="fu">round</span>(sel.table[,<span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>],<span class="dv">1</span>)</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>sel.table[,<span class="dv">4</span>]<span class="ot">&lt;-</span> <span class="fu">round</span>(sel.table[,<span class="dv">4</span>],<span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Wir schreiben den Modellnamen in Spalte <code>Model</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>sel.table<span class="sc">$</span>Model<span class="ot">&lt;-</span><span class="fu">rownames</span>(sel.table)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a>sel.table</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      df  AICc delta weight Model
mod4   5 -27.2   0.0   0.79  mod4
mod1   6 -24.4   2.8   0.19  mod1
mod11  8 -19.5   7.6   0.02 mod11
mod    9 -16.0  11.2   0.00   mod
mod7   4  14.8  42.0   0.00  mod7
mod10  5  16.2  43.4   0.00 mod10
mod3   6  17.3  44.5   0.00  mod3
mod2   6  17.7  44.9   0.00  mod2
mod5   5  56.8  84.0   0.00  mod5
mod8   4  57.2  84.4   0.00  mod8
mod9   4  63.0  90.1   0.00  mod9
mod6   5  65.1  92.3   0.00  mod6
mod0   2  75.9 103.1   0.00  mod0</code></pre>
</div>
</div>
<p>… und schreiben nun die Modellformel in diese Spalte:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(sel.table)) sel.table<span class="sc">$</span>Model[i]<span class="ot">&lt;-</span> <span class="fu">as.character</span>(<span class="fu">formula</span>(<span class="fu">noquote</span>(sel.table<span class="sc">$</span>Model[i]))<span class="sc">$</span>call)[<span class="dv">2</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>sel.table </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      df  AICc delta weight                       Model
mod4   5 -27.2   0.0   0.79          Weeds ~ Arab * Man
mod1   6 -24.4   2.8   0.19     Weeds ~ Arab * Man + SQ
mod11  8 -19.5   7.6   0.02 Weeds ~ (Arab + Man + SQ)^2
mod    9 -16.0  11.2   0.00     Weeds ~ Arab * Man * SQ
mod7   4  14.8  42.0   0.00          Weeds ~ Arab + Man
mod10  5  16.2  43.4   0.00     Weeds ~ Arab + Man + SQ
mod3   6  17.3  44.5   0.00     Weeds ~ Arab * SQ + Man
mod2   6  17.7  44.9   0.00     Weeds ~ Arab + Man * SQ
mod5   5  56.8  84.0   0.00            Weeds ~ Man * SQ
mod8   4  57.2  84.4   0.00            Weeds ~ Man + SQ
mod9   4  63.0  90.1   0.00           Weeds ~ Arab + SQ
mod6   5  65.1  92.3   0.00           Weeds ~ Arab * SQ
mod0   2  75.9 103.1   0.00                   Weeds ~ 1</code></pre>
</div>
</div>
<p>Auch hier könnten wir wieder die Tabelle auf die Modelle reduzieren innerhalb delta AICc &lt; 4 plus globales Modell und Nullmodell.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>sel.table[<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">13</span>),<span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                       Model df  AICc delta weight
mod4      Weeds ~ Arab * Man  5 -27.2   0.0   0.79
mod1 Weeds ~ Arab * Man + SQ  6 -24.4   2.8   0.19
mod  Weeds ~ Arab * Man * SQ  9 -16.0  11.2   0.00
mod0               Weeds ~ 1  2  75.9 103.1   0.00</code></pre>
</div>
</div>
</section>
<section id="modellvergleiche-basierend-auf-aic-mit-glmulti" class="level2">
<h2 class="anchored" data-anchor-id="modellvergleiche-basierend-auf-aic-mit-glmulti">Modellvergleiche basierend auf AIC mit glmulti()</h2>
<p>Ein weiteres Package für Modellvergleiche ist <code>glmulti</code> mit gleichnamiger Funktion. Hier können wir eine Vielzahl an Erklärungsvariablen in einem Vektor (hier <code>pred.var</code>) im Argument <code>xr</code> angeben. Mit <code>maxsize</code> legen wir die maximale Anzahl an Erklärungsvariablen fest. Mit <code>level=1</code> werden nur Haupteffekte gefittet (Bsp. <code>models1</code>), mit <code>level=2</code> werden Haupteffekte und Zweifachinteraktionen gefittet (Bsp. <code>models2</code>).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(glmulti)</span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a>pred.var<span class="ot">=</span><span class="fu">c</span>(<span class="st">"Arab"</span>, <span class="st">"Man"</span>, <span class="st">"SQ"</span>)<span class="co"># alle Erklärungsvariablen</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a>models1 <span class="ot">&lt;-</span> <span class="fu">glmulti</span>(<span class="st">"Weeds"</span>, <span class="at">xr=</span> pred.var, of, <span class="at">crit =</span> aicc, </span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">maxsize =</span> <span class="dv">8</span>, <span class="co"># max 8 Erklärungsvariablen im Modell -&gt; hier nicht wichtig   </span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>                     <span class="at">level =</span> <span class="dv">1</span>,  <span class="co">#  nur Haupteffekte</span></span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>                     <span class="at">fitfunc =</span> lm,  <span class="co"># lineares Model</span></span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>                     <span class="at">confsetsize =</span> <span class="dv">10</span>,  <span class="co"># damit kann man die Anzahl der besten Modelle, die in models1 gespeichert werden, begrenzen</span></span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a>                     <span class="at">marginality=</span><span class="cn">TRUE</span>,  <span class="co"># zur Erklärung vergleiche Bsp. models2 mit models3</span></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a>                     <span class="at">plotty =</span> F, <span class="at">report =</span> F)</span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a>tmp_1 <span class="ot">&lt;-</span> <span class="fu">weightable</span>(models1)</span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a>tmp_1</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                        model     aicc      weights
1      Weeds ~ 1 + Man + Arab 14.79426 6.720119e-01
2 Weeds ~ 1 + Man + Arab + SQ 16.22886 3.279881e-01
3             Weeds ~ 1 + Man 56.75004 5.209496e-10
4        Weeds ~ 1 + Man + SQ 57.23396 4.089908e-10
5            Weeds ~ 1 + Arab 60.44469 8.213205e-11
6       Weeds ~ 1 + Arab + SQ 62.97609 2.316467e-11
7                   Weeds ~ 1 75.88754 3.640339e-14
8              Weeds ~ 1 + SQ 77.99259 1.270677e-14</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>models2 <span class="ot">&lt;-</span> <span class="fu">glmulti</span>(<span class="st">"Weeds"</span>, <span class="at">xr=</span> pred.var, of, <span class="at">crit =</span> aicc, </span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">maxsize =</span> <span class="dv">8</span>, </span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">level =</span> <span class="dv">2</span>,  <span class="co"># fit Haupteffekte und Zweifachinteraktionen  </span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">confsetsize =</span> <span class="dv">10</span>,  </span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">marginality=</span><span class="cn">TRUE</span>,  </span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">plotty =</span> F, <span class="at">report =</span> F)</span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>tmp_2 <span class="ot">&lt;-</span> <span class="fu">weightable</span>(models2)</span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>tmp_2</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                       model      aicc
1                          Weeds ~ 1 + Man + Arab + Man:Arab -27.16372
2                     Weeds ~ 1 + Man + Arab + SQ + Man:Arab -24.36270
3            Weeds ~ 1 + Man + Arab + SQ + Man:Arab + Man:SQ -22.36104
4           Weeds ~ 1 + Man + Arab + SQ + SQ:Arab + Man:Arab -21.73091
5  Weeds ~ 1 + Man + Arab + SQ + SQ:Arab + Man:Arab + Man:SQ -19.53353
6                                     Weeds ~ 1 + Man + Arab  14.79426
7                                Weeds ~ 1 + Man + Arab + SQ  16.22886
8                      Weeds ~ 1 + Man + Arab + SQ + SQ:Arab  17.29047
9                       Weeds ~ 1 + Man + Arab + SQ + Man:SQ  17.70841
10            Weeds ~ 1 + Man + Arab + SQ + SQ:Arab + Man:SQ  18.93916
        weights
1  7.016487e-01
2  1.729359e-01
3  6.356687e-02
4  4.638730e-02
5  1.546125e-02
6  5.433232e-10
7  2.651791e-10
8  1.559601e-10
9  1.265495e-10
10 6.839188e-11</code></pre>
</div>
</div>
<p>Mit dem Argument <code>marginality=FALSE</code> werden auch Modelle mit Interaktionen ohne Haupteffekte gefittet. Hierzu gibt es geteilte Meinungen. Es entstehen mehr mögliche Modelle aus denen das/die beste/n Modell/e gewählt werden können. Gleichzeitig kann aber damit auch ein einfacheres Modell mit weniger Erklärungsvariablen gewählt werden.</p>
<p>Im Bespiel <code>models3</code> sieht man als zweitbestes Modell <code>Weeds ~ Arab + Man:Arab</code>, welches ohne Haupteffekt <code>Man</code> gefittet ist.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a>models3 <span class="ot">&lt;-</span> <span class="fu">glmulti</span>(<span class="st">"Weeds"</span>, <span class="at">xr=</span> pred.var, of, <span class="at">crit =</span> aicc, </span>
<span id="cb88-2"><a href="#cb88-2" aria-hidden="true" tabindex="-1"></a>                     <span class="at">maxsize =</span> <span class="dv">8</span>,  </span>
<span id="cb88-3"><a href="#cb88-3" aria-hidden="true" tabindex="-1"></a>                     <span class="at">level =</span> <span class="dv">2</span>, </span>
<span id="cb88-4"><a href="#cb88-4" aria-hidden="true" tabindex="-1"></a>                     <span class="at">confsetsize =</span> <span class="dv">10</span>,  </span>
<span id="cb88-5"><a href="#cb88-5" aria-hidden="true" tabindex="-1"></a>                     <span class="at">marginality=</span><span class="cn">FALSE</span>,  <span class="co"># fit interaction even if main term is not in the model</span></span>
<span id="cb88-6"><a href="#cb88-6" aria-hidden="true" tabindex="-1"></a>                  <span class="at">plotty =</span> F, <span class="at">report =</span> F)</span>
<span id="cb88-7"><a href="#cb88-7" aria-hidden="true" tabindex="-1"></a>tmp_3 <span class="ot">&lt;-</span> <span class="fu">weightable</span>(models3)</span>
<span id="cb88-8"><a href="#cb88-8" aria-hidden="true" tabindex="-1"></a>tmp_3</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                                                 model      aicc    weights
1                    Weeds ~ 1 + Man + Arab + Man:Arab -27.16372 0.32769924
2                          Weeds ~ 1 + Arab + Man:Arab -25.96858 0.18028255
3            Weeds ~ 1 + Arab + SQ + Man:Arab + Man:SQ -25.43742 0.13823316
4          Weeds ~ 1 + Man + Arab + SQ:Arab + Man:Arab -24.53325 0.08795781
5               Weeds ~ 1 + Man + Arab + SQ + Man:Arab -24.36270 0.08076828
6                     Weeds ~ 1 + Arab + SQ + Man:Arab -23.32596 0.04809674
7                Weeds ~ 1 + Arab + SQ:Arab + Man:Arab -23.27813 0.04696025
8  Weeds ~ 1 + Arab + SQ + SQ:Arab + Man:Arab + Man:SQ -22.86406 0.03817823
9      Weeds ~ 1 + Man + Arab + SQ + Man:Arab + Man:SQ -22.36104 0.02968838
10          Weeds ~ 1 + Arab + SQ + SQ:Arab + Man:Arab -21.77388 0.02213536</code></pre>
</div>
</div>
<p>Alle hier aufgeführten Wege haben zum gleichen besten Modell geführt.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Weeds ~ Arab * Man, data = of)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.27082 -0.12469  0.01851  0.09372  0.25381 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  3.983767   0.097888  40.697  &lt; 2e-16 ***
Arab        -0.027254   0.001525 -17.868  &lt; 2e-16 ***
Manorg      -0.263862   0.137806  -1.915   0.0645 .  
Arab:Manorg  0.019036   0.002146   8.869 3.92e-10 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.149 on 32 degrees of freedom
Multiple R-squared:  0.9538,    Adjusted R-squared:  0.9495 
F-statistic: 220.2 on 3 and 32 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Tip
</div>
</div>
<div class="callout-body-container callout-body">
<p>Die Wahl des besten Modells basiert zwar immer auf einem Informationskriterium (AIC, BIC), der/die R-UserIn kann sich aber auch für das zweit- oder drittbeste Modell entscheiden, wenn darin bspw. Erklärungsvariablen sind, die einfacher oder schneller zu messen sind und das Modell für zukünftige Vorhersagen genutzt werden soll.</p>
</div>
</div>
<section id="übung-6.3." class="level3">
<h3 class="anchored" data-anchor-id="übung-6.3.">Übung 6.3.</h3>
<ul>
<li>Modelliere die Aktivität der Lurche mit der dredge-Funktion.</li>
</ul>
</section>
</section>
<section id="modelldiagnostik" class="level2">
<h2 class="anchored" data-anchor-id="modelldiagnostik">Modelldiagnostik</h2>
<p>Bevor wir das Modell interpretieren, sollten die Modellannahmen visuell überprüft werden, indem wir die Residuen des Modells plotten.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DHARMa)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>This is DHARMa 0.4.6. For overview type '?DHARMa'. For recent changes, type news(package = 'DHARMa')</code></pre>
</div>
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>simulationOutput <span class="ot">&lt;-</span> <span class="fu">simulateResiduals</span>(<span class="at">fittedModel =</span> mod4, <span class="at">plot =</span> F)</span>
<span id="cb94-2"><a href="#cb94-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(simulationOutput)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="06_StatMod_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Keine Auffälligkeiten.</p>
<p>Nun plotten wir noch die Residuen gegen die Erklärungsvariablen</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotResiduals</span>(simulationOutput, <span class="at">form =</span> of<span class="sc">$</span>Man)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="06_StatMod_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Die Varianzen der Residuen sind sehr ähnlich. Wir erinnern uns an den Plot Weeds ~ Man, wo starke Unterschiede in den Varianzen vorkamen. Offensichtlich hat die Erklärungsvariable <code>Arab</code> einen Großteil dieser Variabilität erklärt.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plotResiduals</span>(simulationOutput, <span class="at">form =</span> of<span class="sc">$</span>Arab)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="06_StatMod_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Hier sehen wir eine leichte Kurvatur bei niedrigen Werten in Arab, aber es scheint noch ok zu sein. Wir können zusätzlich noch die vom Modell vorhergesagten vs.&nbsp;gemessenen Daten plotten. Je enger die Beziehung, desto besser.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>of<span class="sc">$</span>fit<span class="ot">=</span><span class="fu">predict</span>(mod4)</span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(of, <span class="fu">aes</span>(<span class="at">y=</span>Weeds, <span class="at">x=</span>fit, <span class="at">colour=</span>Man)) <span class="sc">+</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span><span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="06_StatMod_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="modellinterpretation" class="level2">
<h2 class="anchored" data-anchor-id="modellinterpretation">Modellinterpretation</h2>
<section id="schnell-und-einfach-mit-libraryeffects" class="level3">
<h3 class="anchored" data-anchor-id="schnell-und-einfach-mit-libraryeffects">schnell und einfach mit <code>library(effects)</code></h3>
<div class="cell">
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(effects)</span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">allEffects</span>(mod4))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="06_StatMod_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid" width="518"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">Effect</span>(<span class="fu">c</span>(<span class="st">"Man"</span>), mod4))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="06_StatMod_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid" width="672"></p>
</div>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">Effect</span>(<span class="fu">c</span>(<span class="st">"Arab"</span>), mod4, <span class="at">partial.residuals=</span><span class="cn">TRUE</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="06_StatMod_files/figure-html/unnamed-chunk-52-2.png" class="img-fluid" width="672"></p>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>ef<span class="ot">=</span><span class="fu">allEffects</span>(mod4, <span class="at">xlevels=</span><span class="dv">100</span>)    </span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>ef1<span class="ot">=</span><span class="fu">as.data.frame</span>(ef[[<span class="dv">1</span>]])  </span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(ef1)   </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Arab Man      fit         se    lower    upper
1 21.2 con 3.405986 0.06869007 3.266069 3.545903
2 21.9 con 3.386908 0.06777461 3.248856 3.524961
3 22.7 con 3.365105 0.06673391 3.229173 3.501038
4 23.4 con 3.346027 0.06582835 3.211939 3.480115
5 24.1 con 3.326950 0.06492773 3.194696 3.459203
6 24.9 con 3.305147 0.06390474 3.174977 3.435316</code></pre>
</div>
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(ef1)   </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Arab Man      fit         se    lower    upper
195 90.4 org 2.976989 0.05793205 2.858985 3.094992
196 91.2 org 2.970414 0.05889737 2.850444 3.090384
197 91.9 org 2.964662 0.05974927 2.842956 3.086367
198 92.6 org 2.958909 0.06060762 2.835455 3.082363
199 93.4 org 2.952334 0.06159616 2.826867 3.077802
200 94.1 org 2.946582 0.06246746 2.819340 3.073824</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(of, <span class="fu">aes</span>(<span class="at">x=</span>Arab, <span class="at">y=</span>Weeds, <span class="at">colour=</span>Man)) <span class="sc">+</span></span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> ef1, <span class="fu">aes</span>(<span class="at">x =</span> Arab, <span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">ymin =</span> lower, <span class="at">ymax =</span> upper, </span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>                              <span class="at">linetype=</span><span class="cn">NA</span>, <span class="at">fill=</span>Man), </span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.4</span>, <span class="at">show.legend =</span> F)<span class="sc">+</span></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> ef1, <span class="fu">aes</span>(<span class="at">x =</span> Arab, <span class="at">y =</span> fit))<span class="sc">+</span></span>
<span id="cb106-6"><a href="#cb106-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb106-7"><a href="#cb106-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ylab</span>(<span class="st">"Shannondiversität"</span>)<span class="sc">+</span><span class="fu">xlab</span>(<span class="st">"Ackeranteil (%)"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="06_StatMod_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Wir sehen, dass die Diversität</p>
<ul>
<li>mit zunehmendem Ackeranteil sinkt</li>
<li>generell höher in öko vs.&nbsp;konventionell ist</li>
<li>aber je strukturreicher eine Landschaft (je niedriger der Ackeranteil) desto kleiner fallen auch die Unterschiede zwischen öko vs.&nbsp;konventionell bewirtschafteten Feldern aus.</li>
</ul>
<p>Wir können dies auch gezielt mit einem Posthoc-Test testen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(emmeans)</span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcomp)</span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(multcompView)</span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a><span class="fu">cld</span>(<span class="fu">emmeans</span>(mod4, <span class="sc">~</span>Man<span class="sc">|</span>Arab, <span class="at">at=</span><span class="fu">list</span>(<span class="at">Arab=</span><span class="fu">c</span>(<span class="dv">22</span>,<span class="dv">80</span>))), <span class="at">Letters=</span>letters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Arab = 22:
 Man emmean     SE df lower.CL upper.CL .group
 con   3.38 0.0676 32     3.25     3.52  a    
 org   3.54 0.0671 32     3.40     3.68  a    

Arab = 80:
 Man emmean     SE df lower.CL upper.CL .group
 con   1.80 0.0466 32     1.71     1.90  a    
 org   3.06 0.0464 32     2.97     3.16   b   

Confidence level used: 0.95 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
<p>Hier wird nun an zwei gewählten Punkten (i.e.&nbsp;Ackeranteil von 22% und 80%) die vorhergesagte Diversität in öko vs.&nbsp;kon gestestet. Bei 22% Ackeranteil unterscheidet sich die Diversität nicht signifikant zwischen öko und konventionall, bei 80% Ackeranteil schon.</p>
<p>Man beachte den Unterschied zu folgendem Test, bei dem alle vorhergesagten Levels miteinander verglichen werden.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cld</span>(<span class="fu">emmeans</span>(mod4, <span class="sc">~</span>Man<span class="sc">+</span>Arab, <span class="at">at=</span><span class="fu">list</span>(<span class="at">Arab=</span><span class="fu">c</span>(<span class="dv">22</span>,<span class="dv">80</span>))), <span class="at">sort=</span>F, <span class="at">Letters=</span>letters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> Man Arab emmean     SE df lower.CL upper.CL .group
 con   22   3.38 0.0676 32     3.25     3.52  a    
 org   22   3.54 0.0671 32     3.40     3.68  a    
 con   80   1.80 0.0466 32     1.71     1.90   b   
 org   80   3.06 0.0464 32     2.97     3.16    c  

Confidence level used: 0.95 
P value adjustment: tukey method for comparing a family of 4 estimates 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
<p>Die 22% und 80% sind hier relativ willkürlich gewählt (i.e.&nbsp;zur Demonstration). Man hätte auch das 20- und 80-Perzentil wählen können.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">cld</span>(<span class="fu">emmeans</span>(mod4, <span class="sc">~</span>Man<span class="sc">|</span>Arab, <span class="at">at=</span><span class="fu">list</span>(<span class="at">Arab=</span><span class="fu">quantile</span>(of<span class="sc">$</span>Arab, <span class="at">p=</span><span class="fu">c</span>(<span class="fl">0.2</span>,<span class="fl">0.8</span>)))), <span class="at">sort=</span>F, <span class="at">Letters=</span>letters)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Arab = 36.1:
 Man emmean     SE df lower.CL upper.CL .group
 con   3.00 0.0505 32     2.90     3.10  a    
 org   3.42 0.0502 32     3.32     3.53   b   

Arab = 84.5:
 Man emmean     SE df lower.CL upper.CL .group
 con   1.68 0.0514 32     1.58     1.79  a    
 org   3.03 0.0511 32     2.92     3.13   b   

Confidence level used: 0.95 
significance level used: alpha = 0.05 
NOTE: If two or more means share the same grouping symbol,
      then we cannot show them to be different.
      But we also did not show them to be the same. </code></pre>
</div>
</div>
</section>
<section id="weitere-alternativen-zur-modellinterpretation-i.e.-abbildung-der-ergebnisse" class="level3">
<h3 class="anchored" data-anchor-id="weitere-alternativen-zur-modellinterpretation-i.e.-abbildung-der-ergebnisse">Weitere Alternativen zur Modellinterpretation, i.e.&nbsp;Abbildung der Ergebnisse:</h3>
<section id="mit-geom_smooth" class="level4">
<h4 class="anchored" data-anchor-id="mit-geom_smooth">mit geom_smooth</h4>
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(of, <span class="fu">aes</span>(<span class="at">x=</span>Arab, <span class="at">y=</span>Weeds, <span class="at">colour=</span>Man)) <span class="sc">+</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()<span class="sc">+</span></span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_smooth</span>(<span class="at">method=</span>lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stderr">
<pre><code>`geom_smooth()` using formula = 'y ~ x'</code></pre>
</div>
<div class="cell-output-display">
<p><img src="06_StatMod_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="mit-predict" class="level4">
<h4 class="anchored" data-anchor-id="mit-predict">mit predict</h4>
<p>Wir erstellen einen Testdatensatz <code>td</code> mit allen im besten Modell (<code>mod4</code>) enthaltenen Variablen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(of)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       ID         Man          Arab             SQ            Weeds      
 Min.   : 1.00   con:18   Min.   :21.20   Min.   :38.00   Min.   :1.410  
 1st Qu.: 9.75   org:18   1st Qu.:41.15   1st Qu.:54.75   1st Qu.:2.438  
 Median :18.50            Median :60.50   Median :62.50   Median :2.980  
 Mean   :18.50            Mean   :59.89   Mean   :65.83   Mean   :2.789  
 3rd Qu.:27.25            3rd Qu.:80.65   3rd Qu.:79.25   3rd Qu.:3.290  
 Max.   :36.00            Max.   :94.10   Max.   :95.00   Max.   :3.570  
    Man.con         fit       
 Min.   :0.0   Min.   :1.419  
 1st Qu.:0.0   1st Qu.:2.373  
 Median :0.5   Median :3.006  
 Mean   :0.5   Mean   :2.789  
 3rd Qu.:1.0   3rd Qu.:3.295  
 Max.   :1.0   Max.   :3.544  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>td<span class="ot">&lt;-</span><span class="fu">expand.grid</span>(<span class="at">Arab=</span><span class="fu">seq</span>(<span class="dv">21</span>,<span class="dv">94</span>,<span class="at">length=</span><span class="dv">10</span>), <span class="at">Man=</span><span class="fu">c</span>(<span class="st">"con"</span>,<span class="st">"org"</span>)) </span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>td</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Arab Man
1  21.00000 con
2  29.11111 con
3  37.22222 con
4  45.33333 con
5  53.44444 con
6  61.55556 con
7  69.66667 con
8  77.77778 con
9  85.88889 con
10 94.00000 con
11 21.00000 org
12 29.11111 org
13 37.22222 org
14 45.33333 org
15 53.44444 org
16 61.55556 org
17 69.66667 org
18 77.77778 org
19 85.88889 org
20 94.00000 org</code></pre>
</div>
</div>
<p>und nutzen in der <code>predict</code>-Funktion das Argument <code>interval = "confidence"</code> für die Berechnung des Konfidenzintervalls.</p>
<p><strong>Das Konfidenzintervall</strong></p>
<ul>
<li>zeigt an, in welchem Bereich mit 95 %-er Wahrscheinlichkeit unser “wahrer” Mittelwert liegt</li>
<li>wird kleiner mit größer werdendem Stichprobenumfang</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>td<span class="ot">&lt;-</span><span class="fu">data.frame</span>(td, <span class="fu">predict</span>(mod4, <span class="at">newdata=</span>td, <span class="at">interval =</span> <span class="st">"confidence"</span>))</span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>td</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       Arab Man      fit      lwr      upr
1  21.00000 con 3.411437 3.270985 3.551888
2  29.11111 con 3.190378 3.070923 3.309832
3  37.22222 con 2.969319 2.868908 3.069730
4  45.33333 con 2.748260 2.663611 2.832909
5  53.44444 con 2.527201 2.452914 2.601488
6  61.55556 con 2.306142 2.234435 2.377849
7  69.66667 con 2.085083 2.007396 2.162771
8  77.77778 con 1.864025 1.773477 1.954572
9  85.88889 con 1.642966 1.535111 1.750820
10 94.00000 con 1.421907 1.294093 1.549721
11 21.00000 org 3.547325 3.407978 3.686672
12 29.11111 org 3.480667 3.362037 3.599297
13 37.22222 org 3.414009 3.314143 3.513875
14 45.33333 org 3.347351 3.262982 3.431721
15 53.44444 org 3.280693 3.206479 3.354908
16 61.55556 org 3.214035 3.142327 3.285744
17 69.66667 org 3.147377 3.069782 3.224973
18 77.77778 org 3.080719 2.990472 3.170967
19 85.88889 org 3.014061 2.906763 3.121360
20 94.00000 org 2.947404 2.820416 3.074391</code></pre>
</div>
</div>
<p>Alternativ nutzen wir die <code>predict</code>-Funktion mit dem Argument <code>se.fit</code> für die Berechnung der Standardfehler, die wir für die Berechnung des Konfidenzintervalls nutzen.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>p<span class="ot">&lt;-</span><span class="fu">predict</span>(mod4, <span class="at">newdata=</span>td, <span class="at">se.fit=</span>T) </span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a><span class="fu">str</span>(p)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>List of 4
 $ fit           : Named num [1:20] 3.41 3.19 2.97 2.75 2.53 ...
  ..- attr(*, "names")= chr [1:20] "1" "2" "3" "4" ...
 $ se.fit        : Named num [1:20] 0.069 0.0586 0.0493 0.0416 0.0365 ...
  ..- attr(*, "names")= chr [1:20] "1" "2" "3" "4" ...
 $ df            : int 32
 $ residual.scale: num 0.149</code></pre>
</div>
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>td<span class="sc">$</span>p<span class="ot">&lt;-</span>p<span class="sc">$</span>fit</span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>td<span class="sc">$</span>p.se<span class="ot">&lt;-</span>p<span class="sc">$</span>se.fit</span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a><span class="co">#t-Wert für Konfidenzintervall</span></span>
<span id="cb123-4"><a href="#cb123-4" aria-hidden="true" tabindex="-1"></a>t.val<span class="ot">&lt;-</span><span class="fu">qt</span>(<span class="fl">0.975</span>, mod4<span class="sc">$</span>df)</span>
<span id="cb123-5"><a href="#cb123-5" aria-hidden="true" tabindex="-1"></a>mod4<span class="sc">$</span>df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 32</code></pre>
</div>
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a><span class="co">#berechnet Konfidenzintervall t * SE</span></span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>td<span class="sc">$</span>CI.lwr<span class="ot">&lt;-</span>td<span class="sc">$</span>p<span class="sc">-</span>t.val<span class="sc">*</span>td<span class="sc">$</span>p.se</span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>td<span class="sc">$</span>CI.upr<span class="ot">&lt;-</span>td<span class="sc">$</span>p<span class="sc">+</span>t.val<span class="sc">*</span>td<span class="sc">$</span>p.se</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>Das Vorhersageintervall</strong></p>
<ul>
<li>zeigt an, in welchem Bereich mit 95 %-er Wahrscheinlichkeit zukünftige Beobachtungen liegen</li>
<li>im Allgemeinen größer (weiter) als das Konfidenzintervall</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>td<span class="sc">$</span>PI2<span class="ot">=</span><span class="fu">predict</span>(mod4, td, <span class="at">interval=</span><span class="st">"prediction"</span>)</span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(td)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      Arab Man      fit      lwr      upr        p       p.se   CI.lwr   CI.upr
1 21.00000 con 3.411437 3.270985 3.551888 3.411437 0.06895243 3.270985 3.551888
2 29.11111 con 3.190378 3.070923 3.309832 3.190378 0.05864438 3.070923 3.309832
3 37.22222 con 2.969319 2.868908 3.069730 2.969319 0.04929514 2.868908 3.069730
4 45.33333 con 2.748260 2.663611 2.832909 2.748260 0.04155695 2.663611 2.832909
5 53.44444 con 2.527201 2.452914 2.601488 2.527201 0.03647013 2.452914 2.601488
6 61.55556 con 2.306142 2.234435 2.377849 2.306142 0.03520344 2.234435 2.377849
   PI2.fit  PI2.lwr  PI2.upr
1 3.411437 3.077060 3.745813
2 3.190378 2.864263 3.516492
3 2.969319 2.649689 3.288949
4 2.748260 2.433226 3.063294
5 2.527201 2.214791 2.839611
6 2.306142 1.994336 2.617948</code></pre>
</div>
</div>
<p>und jetzt die Abbildung mit den berechneten Intervallen</p>
<section id="mit-konfidenzintervall" class="level5">
<h5 class="anchored" data-anchor-id="mit-konfidenzintervall">mit Konfidenzintervall</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(of, <span class="fu">aes</span>(<span class="at">x=</span>Arab, <span class="at">y=</span>Weeds, <span class="at">colour=</span>Man)) <span class="sc">+</span></span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> td, <span class="fu">aes</span>(<span class="at">x =</span> Arab, <span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">ymin =</span> lwr, <span class="at">ymax =</span> upr, <span class="at">linetype=</span><span class="cn">NA</span>), </span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">show.legend =</span> F)<span class="sc">+</span></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> td, <span class="fu">aes</span>(<span class="at">x =</span> Arab, <span class="at">y =</span> fit))<span class="sc">+</span></span>
<span id="cb128-5"><a href="#cb128-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="06_StatMod_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="mit-konfidenz--und-vorhersageintervall" class="level5">
<h5 class="anchored" data-anchor-id="mit-konfidenz--und-vorhersageintervall">mit Konfidenz- und Vorhersageintervall</h5>
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(of, <span class="fu">aes</span>(<span class="at">x=</span>Arab, <span class="at">y=</span>Weeds, <span class="at">colour=</span>Man)) <span class="sc">+</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> td, <span class="fu">aes</span>(<span class="at">x =</span> Arab, <span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">ymin =</span> lwr, <span class="at">ymax =</span> upr, <span class="at">linetype=</span><span class="cn">NA</span>), </span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">show.legend =</span> F)<span class="sc">+</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> td, <span class="fu">aes</span>(<span class="at">x =</span> Arab, <span class="at">y =</span> <span class="cn">NULL</span>, <span class="at">ymin =</span> PI2[,<span class="dv">2</span>], <span class="at">ymax =</span> PI2[,<span class="dv">3</span>], <span class="at">linetype=</span><span class="cn">NA</span>), </span>
<span id="cb129-5"><a href="#cb129-5" aria-hidden="true" tabindex="-1"></a>              <span class="at">alpha =</span> <span class="fl">0.2</span>, <span class="at">show.legend =</span> F) <span class="sc">+</span></span>
<span id="cb129-6"><a href="#cb129-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> td, <span class="fu">aes</span>(<span class="at">x =</span> Arab, <span class="at">y =</span> fit)) <span class="sc">+</span></span>
<span id="cb129-7"><a href="#cb129-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="06_StatMod_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
</section>
</section>
<section id="übung-6.4." class="level3">
<h3 class="anchored" data-anchor-id="übung-6.4.">Übung 6.4.</h3>
<ul>
<li>Interpretiere das beste Modell bzw. die besten Modelle.</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>